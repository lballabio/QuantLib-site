<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QuantLib: SobolRsg Class Reference</title>
<link rel="stylesheet" href="/styles/fonts.css" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quantlibextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://www.quantlib.org">QuantLib</a>: a free/open-source library for quantitative finance
   <div id="projectnumber">Reference manual - version 1.38</div>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_quant_lib.html">QuantLib</a></li><li class="navelem"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html">SobolRsg</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_quant_lib_1_1_sobol_rsg-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">SobolRsg Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Sobol low-discrepancy sequence generator.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;ql/math/randomnumbers/sobolrsg.hpp&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:af5254f10d63ffdac50ac07c6df7cc90d" id="r_af5254f10d63ffdac50ac07c6df7cc90d"><td class="memItemLeft" align="right" valign="top"><a id="af5254f10d63ffdac50ac07c6df7cc90d" name="af5254f10d63ffdac50ac07c6df7cc90d"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>DirectionIntegers</b> { <br />
&#160;&#160;<b>Unit</b>
, <b>Jaeckel</b>
, <b>SobolLevitan</b>
, <b>SobolLevitanLemieux</b>
, <br />
&#160;&#160;<b>JoeKuoD5</b>
, <b>JoeKuoD6</b>
, <b>JoeKuoD7</b>
, <b>Kuo</b>
, <br />
&#160;&#160;<b>Kuo2</b>
, <b>Kuo3</b>
<br />
 }</td></tr>
<tr class="separator:af5254f10d63ffdac50ac07c6df7cc90d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3b59a3dd56521693efc68c221a2bf38" id="r_af3b59a3dd56521693efc68c221a2bf38"><td class="memItemLeft" align="right" valign="top"><a id="af3b59a3dd56521693efc68c221a2bf38" name="af3b59a3dd56521693efc68c221a2bf38"></a>
typedef <a class="el" href="struct_quant_lib_1_1_sample.html">Sample</a>&lt; std::vector&lt; <a class="el" href="group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>sample_type</b></td></tr>
<tr class="separator:af3b59a3dd56521693efc68c221a2bf38"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0dd3bd835c526ba7dacc214e50c869c8" id="r_a0dd3bd835c526ba7dacc214e50c869c8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0dd3bd835c526ba7dacc214e50c869c8">SobolRsg</a> (<a class="el" href="group__types.html#gaf38bdb4c54463b1f456655efa95b5c77">Size</a> dimensionality, unsigned long seed=0, DirectionIntegers directionIntegers=Jaeckel, bool useGrayCode=true)</td></tr>
<tr class="separator:a0dd3bd835c526ba7dacc214e50c869c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e375ec58ff84947c3d6eb32d9e35cca" id="r_a2e375ec58ff84947c3d6eb32d9e35cca"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; std::uint32_t &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2e375ec58ff84947c3d6eb32d9e35cca">skipTo</a> (std::uint32_t n) const</td></tr>
<tr class="separator:a2e375ec58ff84947c3d6eb32d9e35cca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55e8d20bcc5c7ee85dd5d80c7466c1c3" id="r_a55e8d20bcc5c7ee85dd5d80c7466c1c3"><td class="memItemLeft" align="right" valign="top"><a id="a55e8d20bcc5c7ee85dd5d80c7466c1c3" name="a55e8d20bcc5c7ee85dd5d80c7466c1c3"></a>
const std::vector&lt; std::uint32_t &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>nextInt32Sequence</b> () const</td></tr>
<tr class="separator:a55e8d20bcc5c7ee85dd5d80c7466c1c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a890c68b5e4749dde1bb3c430df839568" id="r_a890c68b5e4749dde1bb3c430df839568"><td class="memItemLeft" align="right" valign="top"><a id="a890c68b5e4749dde1bb3c430df839568" name="a890c68b5e4749dde1bb3c430df839568"></a>
const <a class="el" href="struct_quant_lib_1_1_sample.html">SobolRsg::sample_type</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>nextSequence</b> () const</td></tr>
<tr class="separator:a890c68b5e4749dde1bb3c430df839568"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa658e9d43811b3ee2cd68f160e0f3430" id="r_aa658e9d43811b3ee2cd68f160e0f3430"><td class="memItemLeft" align="right" valign="top"><a id="aa658e9d43811b3ee2cd68f160e0f3430" name="aa658e9d43811b3ee2cd68f160e0f3430"></a>
const <a class="el" href="struct_quant_lib_1_1_sample.html">sample_type</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>lastSequence</b> () const</td></tr>
<tr class="separator:aa658e9d43811b3ee2cd68f160e0f3430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d909a81181d49375588c96fd1494043" id="r_a6d909a81181d49375588c96fd1494043"><td class="memItemLeft" align="right" valign="top"><a id="a6d909a81181d49375588c96fd1494043" name="a6d909a81181d49375588c96fd1494043"></a>
<a class="el" href="group__types.html#gaf38bdb4c54463b1f456655efa95b5c77">Size</a>&#160;</td><td class="memItemRight" valign="bottom"><b>dimension</b> () const</td></tr>
<tr class="separator:a6d909a81181d49375588c96fd1494043"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Sobol low-discrepancy sequence generator. </p>
<p>A Gray code counter and bitwise operations are used for very fast sequence generation.</p>
<p>The implementation relies on primitive polynomials modulo two from the book "Monte Carlo Methods in Finance" by Peter Jäckel.</p>
<p>21 200 primitive polynomials modulo two are provided in <a class="el" href="namespace_quant_lib.html">QuantLib</a>. Jäckel has calculated 8 129 334 polynomials: if you need that many dimensions you can replace the primitivepolynomials.cpp file included in <a class="el" href="namespace_quant_lib.html">QuantLib</a> with the one provided in the CD of the "Monte Carlo
Methods in Finance" book.</p>
<p>The choice of initialization numbers (also know as free direction integers) is crucial for the homogeneity properties of the sequence. Sobol defines two homogeneity properties: Property A and Property A'.</p>
<p>The unit initialization numbers suggested in "Numerical
Recipes in C", 2nd edition, by Press, Teukolsky, Vetterling, and Flannery (section 7.7) fail the test for Property A even for low dimensions.</p>
<p>Bratley and Fox published coefficients of the free direction integers up to dimension 40, crediting unpublished work of Sobol' and Levitan. See Bratley, P., Fox, B.L. (1988) "Algorithm 659: Implementing Sobol's quasirandom sequence
generator," ACM Transactions on Mathematical Software 14:88-100. These values satisfy Property A for d&lt;=20 and d = 23, 31, 33, 34, 37; Property A' holds for d&lt;=6.</p>
<p>Jäckel provides in his book (section 8.3) initialization numbers up to dimension 32. Coefficients for d&lt;=8 are the same as in Bradley-Fox, so Property A' holds for d&lt;=6 but Property A holds for d&lt;=32.</p>
<p>The implementation of Lemieux, Cieslak, and Luttmer includes coefficients of the free direction integers up to dimension</p><ol type="1">
<li>Coefficients for d&lt;=40 are the same as in Bradley-Fox. For dimension 40&lt;d&lt;=360 the coefficients have been calculated as optimal values based on the "resolution" criterion. See "RandQMC user's guide - A package for
randomized quasi-Monte Carlo methods in C," by C. Lemieux, M. Cieslak, and K. Luttmer, version January 13 2004, and references cited there (<a href="http://www.math.ucalgary.ca/~lemieux/randqmc.html">http://www.math.ucalgary.ca/~lemieux/randqmc.html</a>). The values up to d&lt;=360 has been provided to the <a class="el" href="namespace_quant_lib.html">QuantLib</a> team by Christiane Lemieux, private communication, September 2004.</li>
</ol>
<p>For more info on Sobol' sequences see also "Monte Carlo
Methods in Financial Engineering," by P. Glasserman, 2004, Springer, section 5.2.3</p>
<p>The Joe&ndash;Kuo numbers and the Kuo numbers are due to Stephen Joe and Frances Kuo.</p>
<p>S. Joe and F. Y. Kuo, Constructing Sobol sequences with better two-dimensional projections, preprint Nov 22 2007</p>
<p>See <a href="http://web.maths.unsw.edu.au/~fkuo/sobol/">http://web.maths.unsw.edu.au/~fkuo/sobol/</a> for more information.</p>
<p>The Joe-Kuo numbers are available under a BSD-style license available at the above link.</p>
<p>Note that the Kuo numbers were generated to work with a different ordering of primitive polynomials for the first 40 or so dimensions which is why we have the Alternative Primitive Polynomials.</p>
<dl class="test"><dt><b><a class="el" href="test.html#_test000064">Tests</a></b></dt><dd><ul>
<li>the correctness of the returned values is tested by reproducing known good values.</li>
<li>the correctness of the returned values is tested by checking their discrepancy against known good values. </li>
</ul>
</dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a0dd3bd835c526ba7dacc214e50c869c8" name="a0dd3bd835c526ba7dacc214e50c869c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dd3bd835c526ba7dacc214e50c869c8">&#9670;&#160;</a></span>SobolRsg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_lib_1_1_sobol_rsg.html">SobolRsg</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__types.html#gaf38bdb4c54463b1f456655efa95b5c77">Size</a></td>          <td class="paramname"><span class="paramname"><em>dimensionality</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>seed</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DirectionIntegers</td>          <td class="paramname"><span class="paramname"><em>directionIntegers</em></span><span class="paramdefsep"> = </span><span class="paramdefval">Jaeckel</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>useGrayCode</em></span><span class="paramdefsep"> = </span><span class="paramdefval">true</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel explicit">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The so called generating integer is chosen to be \(\gamma(n) = n\) if useGrayCode is set to false and \(\gamma(n) = G(n)\) where \(G(n)\) is the Gray code of \(n\) otherwise. The Sobol integers are then constructed using formula 8.20 resp. 8.23, see "Monte Carlo Methods in Finance" by Peter Jäckel. The default is to use the Gray code since this allows a faster sequence generation. The <a class="el" href="class_quant_lib_1_1_burley2020_sobol_rsg.html" title="Scrambled sobol sequence according to Burley, 2020.">Burley2020SobolRsg</a> relies on an underlying <a class="el" href="class_quant_lib_1_1_sobol_rsg.html" title="Sobol low-discrepancy sequence generator.">SobolRsg</a> not using the Gray code on the other hand due to its specific way of constructing the integer sequence.</p>
<dl class="section pre"><dt>Precondition</dt><dd>dimensionality must be &lt;= PPMT_MAX_DIM </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2e375ec58ff84947c3d6eb32d9e35cca" name="a2e375ec58ff84947c3d6eb32d9e35cca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e375ec58ff84947c3d6eb32d9e35cca">&#9670;&#160;</a></span>skipTo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; std::uint32_t &gt; &amp; skipTo </td>
          <td>(</td>
          <td class="paramtype">std::uint32_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>skip to the n-th sample in the low-discrepancy sequence </p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.13.2
</small></address>
</body>
</html>
