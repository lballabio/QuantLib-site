<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QuantLib: MulticurveBootstrapping.cpp</title>
<link rel="stylesheet" href="/styles/fonts.css" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quantlibextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://www.quantlib.org">QuantLib</a>: a free/open-source library for quantitative finance
   <div id="projectnumber">Reference manual - version 1.32</div>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">MulticurveBootstrapping.cpp</div></div>
</div><!--header-->
<div class="contents">
<p>This example prices an interest rate swap over a term structure and calculates its fair fixed rate and floating spread.</p>
<div class="fragment"><div class="line"><span class="comment">/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*  This example shows how to set up a term structure with OIS discounting</span></div>
<div class="line"><span class="comment">    and then price a simple 5 year swap.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    Example based on market data in paper by F. M. Ametrano and M. Bianchetti,</span></div>
<div class="line"><span class="comment">    Everything You Always Wanted to Know About Multiple Interest Rate Curve Boostrapping</span></div>
<div class="line"><span class="comment">    but Were Afraid to Ask (April 2, 2013).</span></div>
<div class="line"><span class="comment">    http://ssrn.com/abstract=2219548</span></div>
<div class="line"><span class="comment">    Eonia curve was taken from Figure 25 and Euribor 6m from figure 31.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;ql/qldefines.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#if !defined(BOOST_ALL_NO_LIB) &amp;&amp; defined(BOOST_MSVC)</span></div>
<div class="line"><span class="preprocessor">#  include &lt;ql/auto_link.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/termstructures/yield/piecewiseyieldcurve.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/termstructures/yieldtermstructure.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/termstructures/yield/ratehelpers.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/termstructures/yield/oisratehelper.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/pricingengines/swap/discountingswapengine.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/indexes/ibor/eonia.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/indexes/ibor/euribor.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/time/imm.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/time/calendars/target.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/time/daycounters/actual360.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/time/daycounters/thirty360.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/time/daycounters/actualactual.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/math/interpolations/cubicinterpolation.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ql/math/interpolations/loginterpolation.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_quant_lib.html">QuantLib</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span>, <span class="keywordtype">char</span>* []) {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"><span class="comment">        /*************************</span></div>
<div class="line"><span class="comment">         ***  GLOBAL SETTINGS  ***</span></div>
<div class="line"><span class="comment">         *************************/</span></div>
<div class="line"> </div>
<div class="line">        <a id="_a0" name="_a0"></a><a class="code hl_class" href="class_quant_lib_1_1_calendar.html" title="calendar class">Calendar</a> calendar = <a id="_a1" name="_a1"></a><a class="code hl_class" href="class_quant_lib_1_1_t_a_r_g_e_t.html" title="TARGET calendar">TARGET</a>();</div>
<div class="line"> </div>
<div class="line">        <a id="_a2" name="_a2"></a><a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> todaysDate(11, December, 2012);</div>
<div class="line">        Settings::instance().evaluationDate() = todaysDate;</div>
<div class="line">        todaysDate = Settings::instance().evaluationDate();</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_typedef" href="group__types.html#gab9c87440c314438e51a899a03d2442d0" title="integer number">Integer</a> fixingDays = 2;</div>
<div class="line">        <a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> settlementDate = calendar.<a id="a3" name="a3"></a><a class="code hl_function" href="class_quant_lib_1_1_calendar.html#ab3fc4d2c4ba5243c3f5d51dcb3077ceb">advance</a>(todaysDate, fixingDays, Days);</div>
<div class="line">        <span class="comment">// must be a business day</span></div>
<div class="line">        settlementDate = calendar.<a id="a4" name="a4"></a><a class="code hl_function" href="class_quant_lib_1_1_calendar.html#a712629806d9ef9a39f8144f368c81e4b">adjust</a>(settlementDate);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Today: &quot;</span> &lt;&lt; todaysDate.<a id="a5" name="a5"></a>weekday()</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; todaysDate &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Settlement date: &quot;</span> &lt;&lt; settlementDate.weekday()</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; settlementDate &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"><span class="comment">        /*********************</span></div>
<div class="line"><span class="comment">        **   EONIA CURVE    **</span></div>
<div class="line"><span class="comment">        *********************/</span></div>
<div class="line"> </div>
<div class="line">        <a id="_a6" name="_a6"></a><a class="code hl_class" href="class_quant_lib_1_1_day_counter.html" title="day counter class">DayCounter</a> termStructureDayCounter = <a id="_a7" name="_a7"></a><a class="code hl_class" href="class_quant_lib_1_1_actual365_fixed.html" title="Actual/365 (Fixed) day count convention.">Actual365Fixed</a>();</div>
<div class="line">        std::vector&lt;ext::shared_ptr&lt;RateHelper&gt;&gt; eoniaInstruments;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> eonia = ext::make_shared&lt;Eonia&gt;();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// a SimpleQuote instance stores a value which can be manually changed;</span></div>
<div class="line">        <span class="comment">// other Quote subclasses could read the value from a database</span></div>
<div class="line">        <span class="comment">// or some kind of data feed.</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// RateHelpers are built from the quotes, together with</span></div>
<div class="line">        <span class="comment">// other info depending on the instrument.  Quotes are passed in</span></div>
<div class="line">        <span class="comment">// relinkable handles which could be relinked to some other</span></div>
<div class="line">        <span class="comment">// data source later.</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// deposits</span></div>
<div class="line"> </div>
<div class="line">        std::map&lt;Natural, ext::shared_ptr&lt;Quote&gt;&gt; depoQuotes = {</div>
<div class="line">            <span class="comment">// settlement days, quote</span></div>
<div class="line">            {0, ext::make_shared&lt;SimpleQuote&gt;(0.0004)},</div>
<div class="line">            {1, ext::make_shared&lt;SimpleQuote&gt;(0.0004)},</div>
<div class="line">            {2, ext::make_shared&lt;SimpleQuote&gt;(0.0004)}</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_quant_lib_1_1_day_counter.html" title="day counter class">DayCounter</a> depositDayCounter = <a id="_a8" name="_a8"></a><a class="code hl_class" href="class_quant_lib_1_1_actual360.html" title="Actual/360 day count convention.">Actual360</a>();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; q : depoQuotes) {</div>
<div class="line">            <span class="keyword">auto</span> settlementDays = q.first;</div>
<div class="line">            <span class="keyword">auto</span> quote = q.second;</div>
<div class="line">            <span class="keyword">auto</span> helper = ext::make_shared&lt;DepositRateHelper&gt;(</div>
<div class="line">                <a id="_a9" name="_a9"></a><a class="code hl_class" href="class_quant_lib_1_1_handle.html" title="Shared handle to an observable.">Handle&lt;Quote&gt;</a>(quote),</div>
<div class="line">                1 * Days, settlementDays,</div>
<div class="line">                calendar, Following,</div>
<div class="line">                <span class="keyword">false</span>, depositDayCounter);</div>
<div class="line">            eoniaInstruments.push_back(helper);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// short-term OIS</span></div>
<div class="line"> </div>
<div class="line">        std::map&lt;Period, ext::shared_ptr&lt;Quote&gt;&gt; shortOisQuotes = {</div>
<div class="line">            {1 * Weeks, ext::make_shared&lt;SimpleQuote&gt;(0.00070)},</div>
<div class="line">            {2 * Weeks, ext::make_shared&lt;SimpleQuote&gt;(0.00069)},</div>
<div class="line">            {3 * Weeks, ext::make_shared&lt;SimpleQuote&gt;(0.00078)},</div>
<div class="line">            {1 * Months, ext::make_shared&lt;SimpleQuote&gt;(0.00074)}</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; q : shortOisQuotes) {</div>
<div class="line">            <span class="keyword">auto</span> tenor = q.first;</div>
<div class="line">            <span class="keyword">auto</span> quote = q.second;</div>
<div class="line">            <span class="keyword">auto</span> helper = ext::make_shared&lt;OISRateHelper&gt;(</div>
<div class="line">                2, tenor, <a class="code hl_class" href="class_quant_lib_1_1_handle.html" title="Shared handle to an observable.">Handle&lt;Quote&gt;</a>(quote), eonia);</div>
<div class="line">            eoniaInstruments.push_back(helper);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Dated OIS</span></div>
<div class="line"> </div>
<div class="line">        std::map&lt;std::pair&lt;Date, Date&gt;, ext::shared_ptr&lt;Quote&gt;&gt; datedOisQuotes = {</div>
<div class="line">            {{<a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(16, January, 2013), <a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(13, February, 2013)}, ext::make_shared&lt;SimpleQuote&gt;( 0.000460)},</div>
<div class="line">            {{<a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(13, February, 2013), <a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(13, March, 2013)}, ext::make_shared&lt;SimpleQuote&gt;( 0.000160)},</div>
<div class="line">            {{<a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(13, March, 2013), <a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(10, April, 2013)}, ext::make_shared&lt;SimpleQuote&gt;(-0.000070)},</div>
<div class="line">            {{<a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(10, April, 2013), <a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(8, May, 2013)}, ext::make_shared&lt;SimpleQuote&gt;(-0.000130)},</div>
<div class="line">            {{<a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(8, May, 2013), <a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a>(12, June, 2013)}, ext::make_shared&lt;SimpleQuote&gt;(-0.000140)},</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; q : datedOisQuotes) {</div>
<div class="line">            <span class="keyword">auto</span> startDate = q.first.first;</div>
<div class="line">            <span class="keyword">auto</span> endDate = q.first.second;</div>
<div class="line">            <span class="keyword">auto</span> quote = q.second;</div>
<div class="line">            <span class="keyword">auto</span> helper = ext::make_shared&lt;DatedOISRateHelper&gt;(</div>
<div class="line">                startDate, endDate, <a class="code hl_class" href="class_quant_lib_1_1_handle.html" title="Shared handle to an observable.">Handle&lt;Quote&gt;</a>(quote), eonia);</div>
<div class="line">            eoniaInstruments.push_back(helper);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// long-term OIS</span></div>
<div class="line"> </div>
<div class="line">        std::map&lt;Period, ext::shared_ptr&lt;Quote&gt;&gt; longOisQuotes = {</div>
<div class="line">            {15 * Months, ext::make_shared&lt;SimpleQuote&gt;(0.00002)},</div>
<div class="line">            {18 * Months, ext::make_shared&lt;SimpleQuote&gt;(0.00008)},</div>
<div class="line">            {21 * Months, ext::make_shared&lt;SimpleQuote&gt;(0.00021)},</div>
<div class="line">            {2 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.00036)},</div>
<div class="line">            {3 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.00127)},</div>
<div class="line">            {4 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.00274)},</div>
<div class="line">            {5 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.00456)},</div>
<div class="line">            {6 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.00647)},</div>
<div class="line">            {7 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.00827)},</div>
<div class="line">            {8 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.00996)},</div>
<div class="line">            {9 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.01147)},</div>
<div class="line">            {10 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.0128)},</div>
<div class="line">            {11 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.01404)},</div>
<div class="line">            {12 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.01516)},</div>
<div class="line">            {15 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.01764)},</div>
<div class="line">            {20 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.01939)},</div>
<div class="line">            {25 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.02003)},</div>
<div class="line">            {30 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.02038)}</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; q : longOisQuotes) {</div>
<div class="line">            <span class="keyword">auto</span> tenor = q.first;</div>
<div class="line">            <span class="keyword">auto</span> quote = q.second;</div>
<div class="line">            <span class="keyword">auto</span> helper = ext::make_shared&lt;OISRateHelper&gt;(</div>
<div class="line">                2, tenor, <a class="code hl_class" href="class_quant_lib_1_1_handle.html" title="Shared handle to an observable.">Handle&lt;Quote&gt;</a>(quote), eonia);</div>
<div class="line">            eoniaInstruments.push_back(helper);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// curve</span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> eoniaTermStructure = ext::make_shared&lt;PiecewiseYieldCurve&lt;Discount, Cubic&gt;&gt;(</div>
<div class="line">                todaysDate, eoniaInstruments, termStructureDayCounter);</div>
<div class="line"> </div>
<div class="line">        eoniaTermStructure-&gt;enableExtrapolation();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// This curve will be used for discounting cash flows</span></div>
<div class="line">        <a id="_a10" name="_a10"></a><a class="code hl_class" href="class_quant_lib_1_1_relinkable_handle.html" title="Relinkable handle to an observable.">RelinkableHandle&lt;YieldTermStructure&gt;</a> discountingTermStructure;</div>
<div class="line">        discountingTermStructure.<a id="a11" name="a11"></a>linkTo(eoniaTermStructure);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">        /**************************</span></div>
<div class="line"><span class="comment">        **    EURIBOR 6M CURVE   **</span></div>
<div class="line"><span class="comment">        ***************************/</span></div>
<div class="line"> </div>
<div class="line">        std::vector&lt;ext::shared_ptr&lt;RateHelper&gt;&gt; euribor6MInstruments;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> euribor6M = ext::make_shared&lt;Euribor6M&gt;();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// deposits</span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> d6MRate = ext::make_shared&lt;SimpleQuote&gt;(0.00312);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> d6M = ext::make_shared&lt;DepositRateHelper&gt;(</div>
<div class="line">            <a class="code hl_class" href="class_quant_lib_1_1_handle.html" title="Shared handle to an observable.">Handle&lt;Quote&gt;</a>(d6MRate),</div>
<div class="line">            6 * Months, 3,</div>
<div class="line">            calendar, Following,</div>
<div class="line">            <span class="keyword">false</span>, depositDayCounter);</div>
<div class="line"> </div>
<div class="line">        euribor6MInstruments.push_back(d6M);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// FRAs</span></div>
<div class="line"> </div>
<div class="line">        std::map&lt;Natural, ext::shared_ptr&lt;Quote&gt;&gt; fraQuotes = {</div>
<div class="line">            {1, ext::make_shared&lt;SimpleQuote&gt;(0.002930)},</div>
<div class="line">            {2, ext::make_shared&lt;SimpleQuote&gt;(0.002720)},</div>
<div class="line">            {3, ext::make_shared&lt;SimpleQuote&gt;(0.002600)},</div>
<div class="line">            {4, ext::make_shared&lt;SimpleQuote&gt;(0.002560)},</div>
<div class="line">            {5, ext::make_shared&lt;SimpleQuote&gt;(0.002520)},</div>
<div class="line">            {6, ext::make_shared&lt;SimpleQuote&gt;(0.002480)},</div>
<div class="line">            {7, ext::make_shared&lt;SimpleQuote&gt;(0.002540)},</div>
<div class="line">            {8, ext::make_shared&lt;SimpleQuote&gt;(0.002610)},</div>
<div class="line">            {9, ext::make_shared&lt;SimpleQuote&gt;(0.002670)},</div>
<div class="line">            {10, ext::make_shared&lt;SimpleQuote&gt;(0.002790)},</div>
<div class="line">            {11, ext::make_shared&lt;SimpleQuote&gt;(0.002910)},</div>
<div class="line">            {12, ext::make_shared&lt;SimpleQuote&gt;(0.003030)},</div>
<div class="line">            {13, ext::make_shared&lt;SimpleQuote&gt;(0.003180)},</div>
<div class="line">            {14, ext::make_shared&lt;SimpleQuote&gt;(0.003350)},</div>
<div class="line">            {15, ext::make_shared&lt;SimpleQuote&gt;(0.003520)},</div>
<div class="line">            {16, ext::make_shared&lt;SimpleQuote&gt;(0.003710)},</div>
<div class="line">            {17, ext::make_shared&lt;SimpleQuote&gt;(0.003890)},</div>
<div class="line">            {18, ext::make_shared&lt;SimpleQuote&gt;(0.004090)}</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; q : fraQuotes) {</div>
<div class="line">            <span class="keyword">auto</span> monthsToStart = q.first;</div>
<div class="line">            <span class="keyword">auto</span> quote = q.second;</div>
<div class="line">            <span class="keyword">auto</span> helper = ext::make_shared&lt;FraRateHelper&gt;(</div>
<div class="line">                <a class="code hl_class" href="class_quant_lib_1_1_handle.html" title="Shared handle to an observable.">Handle&lt;Quote&gt;</a>(quote),</div>
<div class="line">                monthsToStart, euribor6M);</div>
<div class="line">            euribor6MInstruments.push_back(helper);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// swaps</span></div>
<div class="line"> </div>
<div class="line">        std::map&lt;Period, ext::shared_ptr&lt;Quote&gt;&gt; swapQuotes = {</div>
<div class="line">            {3 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.004240)},</div>
<div class="line">            {4 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.005760)},</div>
<div class="line">            {5 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.007620)},</div>
<div class="line">            {6 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.009540)},</div>
<div class="line">            {7 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.011350)},</div>
<div class="line">            {8 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.013030)},</div>
<div class="line">            {9 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.014520)},</div>
<div class="line">            {10 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.015840)},</div>
<div class="line">            {12 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.018090)},</div>
<div class="line">            {15 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.020370)},</div>
<div class="line">            {20 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.021870)},</div>
<div class="line">            {25 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.022340)},</div>
<div class="line">            {30 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.022560)},</div>
<div class="line">            {35 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.022950)},</div>
<div class="line">            {40 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.023480)},</div>
<div class="line">            {50 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.024210)},</div>
<div class="line">            {60 * Years, ext::make_shared&lt;SimpleQuote&gt;(0.024630)}</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumeration" href="group__datetime.html#ga6d41db8ba0ea90d22df35889df452ada" title="Frequency of events.">Frequency</a> swFixedLegFrequency = Annual;</div>
<div class="line">        <a class="code hl_enumeration" href="group__datetime.html#gaff46c5ae9385d20709bedade86edd368" title="Business Day conventions.">BusinessDayConvention</a> swFixedLegConvention = Unadjusted;</div>
<div class="line">        <a class="code hl_class" href="class_quant_lib_1_1_day_counter.html" title="day counter class">DayCounter</a> swFixedLegDayCounter = <a id="_a12" name="_a12"></a><a class="code hl_class" href="class_quant_lib_1_1_thirty360.html" title="30/360 day count convention">Thirty360</a>(Thirty360::European);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; q : swapQuotes) {</div>
<div class="line">            <span class="keyword">auto</span> tenor = q.first;</div>
<div class="line">            <span class="keyword">auto</span> quote = q.second;</div>
<div class="line">            <span class="keyword">auto</span> helper = ext::make_shared&lt;SwapRateHelper&gt;(</div>
<div class="line">                <a class="code hl_class" href="class_quant_lib_1_1_handle.html" title="Shared handle to an observable.">Handle&lt;Quote&gt;</a>(quote), tenor,</div>
<div class="line">                calendar, swFixedLegFrequency,</div>
<div class="line">                swFixedLegConvention, swFixedLegDayCounter,</div>
<div class="line">                euribor6M,</div>
<div class="line">                <a class="code hl_class" href="class_quant_lib_1_1_handle.html" title="Shared handle to an observable.">Handle&lt;Quote&gt;</a>(), 0 * Days,</div>
<div class="line">                discountingTermStructure); <span class="comment">// the Eonia curve is used for discounting</span></div>
<div class="line">            euribor6MInstruments.push_back(helper);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// If needed, it&#39;s possible to change the tolerance; the default is 1.0e-12.</span></div>
<div class="line">        <span class="comment">// The tolerance is passed in an explicit bootstrap object. Depending on</span></div>
<div class="line">        <span class="comment">// the bootstrap algorithm, it&#39;s possible to pass other parameters.</span></div>
<div class="line">        <span class="keywordtype">double</span> tolerance = 1.0e-15;</div>
<div class="line">        <span class="keyword">auto</span> euribor6MTermStructure = ext::make_shared&lt;PiecewiseYieldCurve&lt;Discount, Cubic&gt;&gt;(</div>
<div class="line">                settlementDate, euribor6MInstruments,</div>
<div class="line">                termStructureDayCounter,</div>
<div class="line">                PiecewiseYieldCurve&lt;Discount, Cubic&gt;::bootstrap_type(tolerance));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// This curve will be used for forward-rate forecasting</span></div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_quant_lib_1_1_relinkable_handle.html" title="Relinkable handle to an observable.">RelinkableHandle&lt;YieldTermStructure&gt;</a> forecastingTermStructure;</div>
<div class="line">        forecastingTermStructure.linkTo(euribor6MTermStructure);</div>
<div class="line"> </div>
<div class="line"><span class="comment">        /*********************</span></div>
<div class="line"><span class="comment">        * SWAPS TO BE PRICED *</span></div>
<div class="line"><span class="comment">        **********************/</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// constant nominal 1,000,000 Euro</span></div>
<div class="line">        <a class="code hl_typedef" href="group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78" title="real number">Real</a> nominal = 1000000.0;</div>
<div class="line">        <span class="comment">// fixed leg</span></div>
<div class="line">        <a class="code hl_enumeration" href="group__datetime.html#ga6d41db8ba0ea90d22df35889df452ada" title="Frequency of events.">Frequency</a> fixedLegFrequency = Annual;</div>
<div class="line">        <a class="code hl_enumeration" href="group__datetime.html#gaff46c5ae9385d20709bedade86edd368" title="Business Day conventions.">BusinessDayConvention</a> fixedLegConvention = Unadjusted;</div>
<div class="line">        <a class="code hl_enumeration" href="group__datetime.html#gaff46c5ae9385d20709bedade86edd368" title="Business Day conventions.">BusinessDayConvention</a> floatingLegConvention = ModifiedFollowing;</div>
<div class="line">        <a class="code hl_class" href="class_quant_lib_1_1_day_counter.html" title="day counter class">DayCounter</a> fixedLegDayCounter = <a class="code hl_class" href="class_quant_lib_1_1_thirty360.html" title="30/360 day count convention">Thirty360</a>(Thirty360::European);</div>
<div class="line">        <a class="code hl_typedef" href="group__types.html#gaede435af51236692b1107d7639581d39" title="interest rates">Rate</a> fixedRate = 0.007;</div>
<div class="line">        <a class="code hl_class" href="class_quant_lib_1_1_day_counter.html" title="day counter class">DayCounter</a> floatingLegDayCounter = <a class="code hl_class" href="class_quant_lib_1_1_actual360.html" title="Actual/360 day count convention.">Actual360</a>();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// floating leg</span></div>
<div class="line">        <a class="code hl_enumeration" href="group__datetime.html#ga6d41db8ba0ea90d22df35889df452ada" title="Frequency of events.">Frequency</a> floatingLegFrequency = Semiannual;</div>
<div class="line">        <span class="keyword">auto</span> euriborIndex = ext::make_shared&lt;Euribor6M&gt;(forecastingTermStructure);</div>
<div class="line">        <a class="code hl_typedef" href="group__types.html#gae7427f4743503002b0c6eeeefae91a3d" title="spreads on interest rates">Spread</a> spread = 0.0;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_typedef" href="group__types.html#gab9c87440c314438e51a899a03d2442d0" title="integer number">Integer</a> lengthInYears = 5;</div>
<div class="line">        <a class="code hl_enumeration" href="class_quant_lib_1_1_swap.html#a1d1cfd8ffb84e947f82999c682b666a7">Swap::Type</a> swapType = Swap::Payer;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> maturity = settlementDate + lengthInYears*Years;</div>
<div class="line">        <a id="_a13" name="_a13"></a><a class="code hl_class" href="class_quant_lib_1_1_schedule.html" title="Payment schedule.">Schedule</a> fixedSchedule(settlementDate, maturity,</div>
<div class="line">                               <a id="_a14" name="_a14"></a><a class="code hl_class" href="class_quant_lib_1_1_period.html">Period</a>(fixedLegFrequency),</div>
<div class="line">                               calendar, fixedLegConvention,</div>
<div class="line">                               fixedLegConvention,</div>
<div class="line">                               DateGeneration::Forward, <span class="keyword">false</span>);</div>
<div class="line">        <a class="code hl_class" href="class_quant_lib_1_1_schedule.html" title="Payment schedule.">Schedule</a> floatSchedule(settlementDate, maturity,</div>
<div class="line">                               <a class="code hl_class" href="class_quant_lib_1_1_period.html">Period</a>(floatingLegFrequency),</div>
<div class="line">                               calendar, floatingLegConvention,</div>
<div class="line">                               floatingLegConvention,</div>
<div class="line">                               DateGeneration::Forward, <span class="keyword">false</span>);</div>
<div class="line">        <a id="_a15" name="_a15"></a><a class="code hl_class" href="class_quant_lib_1_1_vanilla_swap.html" title="Plain-vanilla swap: fix vs ibor leg.">VanillaSwap</a> spot5YearSwap(swapType, nominal,</div>
<div class="line">            fixedSchedule, fixedRate, fixedLegDayCounter,</div>
<div class="line">            floatSchedule, euriborIndex, spread,</div>
<div class="line">            floatingLegDayCounter);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> fwdStart = calendar.<a class="code hl_function" href="class_quant_lib_1_1_calendar.html#ab3fc4d2c4ba5243c3f5d51dcb3077ceb">advance</a>(settlementDate, 1, Years);</div>
<div class="line">        <a class="code hl_class" href="class_quant_lib_1_1_date.html" title="Concrete date class.">Date</a> fwdMaturity = fwdStart + lengthInYears*Years;</div>
<div class="line">        <a class="code hl_class" href="class_quant_lib_1_1_schedule.html" title="Payment schedule.">Schedule</a> fwdFixedSchedule(fwdStart, fwdMaturity,</div>
<div class="line">                                  <a class="code hl_class" href="class_quant_lib_1_1_period.html">Period</a>(fixedLegFrequency),</div>
<div class="line">                                  calendar, fixedLegConvention,</div>
<div class="line">                                  fixedLegConvention,</div>
<div class="line">                                  DateGeneration::Forward, <span class="keyword">false</span>);</div>
<div class="line">        <a class="code hl_class" href="class_quant_lib_1_1_schedule.html" title="Payment schedule.">Schedule</a> fwdFloatSchedule(fwdStart, fwdMaturity,</div>
<div class="line">                                  <a class="code hl_class" href="class_quant_lib_1_1_period.html">Period</a>(floatingLegFrequency),</div>
<div class="line">                                  calendar, floatingLegConvention,</div>
<div class="line">                                  floatingLegConvention,</div>
<div class="line">                                  DateGeneration::Forward, <span class="keyword">false</span>);</div>
<div class="line">        <a class="code hl_class" href="class_quant_lib_1_1_vanilla_swap.html" title="Plain-vanilla swap: fix vs ibor leg.">VanillaSwap</a> oneYearForward5YearSwap(swapType, nominal,</div>
<div class="line">            fwdFixedSchedule, fixedRate, fixedLegDayCounter,</div>
<div class="line">            fwdFloatSchedule, euriborIndex, spread,</div>
<div class="line">            floatingLegDayCounter);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">        /***************</span></div>
<div class="line"><span class="comment">        * SWAP PRICING *</span></div>
<div class="line"><span class="comment">        ****************/</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// utilities for formatting the report</span></div>
<div class="line"> </div>
<div class="line">        std::ostringstream s1;</div>
<div class="line">        s1 &lt;&lt; <span class="stringliteral">&quot;5-years swap paying &quot;</span> &lt;&lt; std::setprecision(2) &lt;&lt; io::rate(fixedRate);</div>
<div class="line">        std::string case1 = s1.str();</div>
<div class="line"> </div>
<div class="line">        std::ostringstream s2;</div>
<div class="line">        s2 &lt;&lt; <span class="stringliteral">&quot;5-years, 1-year forward swap paying &quot;</span> &lt;&lt; std::setprecision(2) &lt;&lt; io::rate(fixedRate);</div>
<div class="line">        std::string case2 = s2.str();</div>
<div class="line"> </div>
<div class="line">        std::vector&lt;std::string&gt; headers(4);</div>
<div class="line">        headers[0] = std::string(std::max(case1.size(), case2.size()) + 1, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line">        headers[1] = <span class="stringliteral">&quot;net present value&quot;</span>;</div>
<div class="line">        headers[2] = <span class="stringliteral">&quot;fair spread&quot;</span>;</div>
<div class="line">        headers[3] = <span class="stringliteral">&quot;fair fixed rate&quot;</span>;</div>
<div class="line">        std::string separator = <span class="stringliteral">&quot; | &quot;</span>;</div>
<div class="line">        std::string header = headers[0] + separator + headers[1] + separator + headers[2] + separator + headers[3];</div>
<div class="line">        <a class="code hl_typedef" href="group__types.html#gaf38bdb4c54463b1f456655efa95b5c77" title="size of a container">Size</a> width = header.size();</div>
<div class="line">        std::string rule(width, <span class="charliteral">&#39;-&#39;</span>), dblrule(width, <span class="charliteral">&#39;=&#39;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// calculations</span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> s5yRate = swapQuotes[5 * Years];</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; dblrule &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot; With 5-year market swap-rate = &quot;</span></div>
<div class="line">                  &lt;&lt; std::setprecision(2) &lt;&lt; io::rate(s5yRate-&gt;value())</div>
<div class="line">                  &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; rule &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; header &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; rule &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_typedef" href="group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78" title="real number">Real</a> NPV;</div>
<div class="line">        <a class="code hl_typedef" href="group__types.html#gaede435af51236692b1107d7639581d39" title="interest rates">Rate</a> fairRate;</div>
<div class="line">        <a class="code hl_typedef" href="group__types.html#gae7427f4743503002b0c6eeeefae91a3d" title="spreads on interest rates">Spread</a> fairSpread;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> swapEngine = ext::make_shared&lt;DiscountingSwapEngine&gt;(discountingTermStructure);</div>
<div class="line"> </div>
<div class="line">        spot5YearSwap.<a id="a16" name="a16"></a><a class="code hl_function" href="class_quant_lib_1_1_instrument.html#ae58e4c75062c7f3f4dedbd744f9a379f" title="set the pricing engine to be used.">setPricingEngine</a>(swapEngine);</div>
<div class="line">        oneYearForward5YearSwap.<a class="code hl_function" href="class_quant_lib_1_1_instrument.html#ae58e4c75062c7f3f4dedbd744f9a379f" title="set the pricing engine to be used.">setPricingEngine</a>(swapEngine);</div>
<div class="line"> </div>
<div class="line">        NPV = spot5YearSwap.<a id="a17" name="a17"></a><a class="code hl_function" href="class_quant_lib_1_1_instrument.html#a4f791921f063f3ea19bd6efa9ceb4892" title="returns the net present value of the instrument.">NPV</a>();</div>
<div class="line">        fairSpread = spot5YearSwap.<a id="a18" name="a18"></a>fairSpread();</div>
<div class="line">        fairRate = spot5YearSwap.<a id="a19" name="a19"></a>fairRate();</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[0].size())</div>
<div class="line">                  &lt;&lt; case1 &lt;&lt; separator;</div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[1].size())</div>
<div class="line">                  &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; NPV &lt;&lt; separator;</div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[2].size())</div>
<div class="line">                  &lt;&lt; io::rate(fairSpread) &lt;&lt; separator;</div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[3].size())</div>
<div class="line">                  &lt;&lt; io::rate(fairRate);</div>
<div class="line">        std::cout &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; rule &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// let&#39;s check that the 5 years swap has been correctly re-priced</span></div>
<div class="line">        QL_REQUIRE(std::fabs(fairRate-s5yRate-&gt;value())&lt;1e-8,</div>
<div class="line">                   <span class="stringliteral">&quot;5-years swap mispriced by &quot;</span></div>
<div class="line">                   &lt;&lt; io::rate(std::fabs(fairRate-s5yRate-&gt;value())));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// now let&#39;s price the 1Y forward 5Y swap</span></div>
<div class="line"> </div>
<div class="line">        NPV = oneYearForward5YearSwap.<a class="code hl_function" href="class_quant_lib_1_1_instrument.html#a4f791921f063f3ea19bd6efa9ceb4892" title="returns the net present value of the instrument.">NPV</a>();</div>
<div class="line">        fairSpread = oneYearForward5YearSwap.fairSpread();</div>
<div class="line">        fairRate = oneYearForward5YearSwap.fairRate();</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[0].size())</div>
<div class="line">                  &lt;&lt; case2 &lt;&lt; separator;</div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[1].size())</div>
<div class="line">                  &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; NPV &lt;&lt; separator;</div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[2].size())</div>
<div class="line">                  &lt;&lt; io::rate(fairSpread) &lt;&lt; separator;</div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[3].size())</div>
<div class="line">                  &lt;&lt; io::rate(fairRate);</div>
<div class="line">        std::cout &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// now let&#39;s say that the 5-years swap rate goes up to 0.90%.</span></div>
<div class="line">        <span class="comment">// A smarter market element--say, connected to a data source-- would</span></div>
<div class="line">        <span class="comment">// notice the change itself. Since we&#39;re using SimpleQuotes,</span></div>
<div class="line">        <span class="comment">// we&#39;ll have to change the value manually--which forces us to</span></div>
<div class="line">        <span class="comment">// downcast the handle and use the SimpleQuote</span></div>
<div class="line">        <span class="comment">// interface. In any case, the point here is that a change in the</span></div>
<div class="line">        <span class="comment">// value contained in the Quote triggers a new bootstrapping</span></div>
<div class="line">        <span class="comment">// of the curve and a repricing of the swap.</span></div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> fiveYearsRate = ext::dynamic_pointer_cast&lt;SimpleQuote&gt;(s5yRate);</div>
<div class="line">        fiveYearsRate-&gt;setValue(0.0090);</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; dblrule &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot; With 5-year market swap-rate = &quot;</span></div>
<div class="line">                  &lt;&lt; io::rate(s5yRate-&gt;value()) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; rule &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; header &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; rule &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// now get the updated results</span></div>
<div class="line"> </div>
<div class="line">        NPV = spot5YearSwap.<a class="code hl_function" href="class_quant_lib_1_1_instrument.html#a4f791921f063f3ea19bd6efa9ceb4892" title="returns the net present value of the instrument.">NPV</a>();</div>
<div class="line">        fairSpread = spot5YearSwap.fairSpread();</div>
<div class="line">        fairRate = spot5YearSwap.fairRate();</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[0].size())</div>
<div class="line">                  &lt;&lt; case1 &lt;&lt; separator;</div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[1].size())</div>
<div class="line">                  &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; NPV &lt;&lt; separator;</div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[2].size())</div>
<div class="line">                  &lt;&lt; io::rate(fairSpread) &lt;&lt; separator;</div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[3].size())</div>
<div class="line">                  &lt;&lt; io::rate(fairRate);</div>
<div class="line">        std::cout &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        QL_REQUIRE(std::fabs(fairRate-s5yRate-&gt;value())&lt;1e-8,</div>
<div class="line">                   <span class="stringliteral">&quot;5-years swap mispriced!&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; rule &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// the 1Y forward 5Y swap doesn&#39;t change;</span></div>
<div class="line">        <span class="comment">// it depends on the 1-year and 6-years rates, which didn&#39;t move</span></div>
<div class="line"> </div>
<div class="line">        NPV = oneYearForward5YearSwap.<a class="code hl_function" href="class_quant_lib_1_1_instrument.html#a4f791921f063f3ea19bd6efa9ceb4892" title="returns the net present value of the instrument.">NPV</a>();</div>
<div class="line">        fairSpread = oneYearForward5YearSwap.fairSpread();</div>
<div class="line">        fairRate = oneYearForward5YearSwap.fairRate();</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[0].size())</div>
<div class="line">                  &lt;&lt; case2 &lt;&lt; separator;</div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[1].size())</div>
<div class="line">                  &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; NPV &lt;&lt; separator;</div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[2].size())</div>
<div class="line">                  &lt;&lt; io::rate(fairSpread) &lt;&lt; separator;</div>
<div class="line">        std::cout &lt;&lt; std::setw(headers[3].size())</div>
<div class="line">                  &lt;&lt; io::rate(fairRate);</div>
<div class="line">        std::cout &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; dblrule &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (std::exception&amp; e) {</div>
<div class="line">        std::cerr &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    } <span class="keywordflow">catch</span> (...) {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;unknown error&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.9.8
</small></address>
</body>
</html>
