<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>QuantLibAddin: Build QuantLib Calc Addin on Windows and/or Linux</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="tabs.css">
    <link rel="stylesheet" href="ql.css">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id='wrapper'>
        <div id='header'>
        <div id='floatleft'><a class="imglink" href="index.html"><img src="images/logo_qla.jpg" width="180" height="72" border="0" alt="QuantLibAddin Logo"/></a></div>
        <div id='floatright'><a class="imglink" href="http://quantlib.org"><img src="images/logo_ql.jpg" width="130" height="82" border="0" alt="QuantLib Logo"/></a></div>
        </div>
        <div id='content'>
            <div id='col-left'>
            <div id="version">Version 1.14.0</div>
                <div id='sidebar'>
<ul>
<li class="menuheader"><a href="index.html">Home</a></li>
<li><a href="installation.html">Installation</a></li>
<li><a href="design.html">Design</a></li>
<li><a href="history.html">History</a></li>
<li><a href="license.html">License</a></li>
<li><a href="people.html">People</a></li>
<li><a href="faq.html">FAQ</a></li>
<li class="menuheader"><a href="functional.html">Functional<br>Documentation</a></li>
<li><a href="manual.html">Manual</a></li>
<li><a href="allfunctions.html">Functions</a></li>
<li><a href="categories.html">Categories</a></li>
<li><a href="enums.html">Enumerations</a></li>
<li class="menuheader"><a href="technical.html">Technical<br>Documentation</a></li>
<li><a href="tutorials.html">Tutorials</a></li>
<li><a href="annotated.html">Classes</a></li>
<li><a href="hierarchy.html">Hierarchy</a></li>
<li><a href="files.html">Files</a></li>
<li><a href="examples.html">Examples</a></li>
</ul>
                </div>
<div class="logo">
<div class="vspace"></div>
<a href="http://www.reposit.be" id="reposit_logo"></a>
<div class="vspace"></div>
<a class="imglink" href="http://sourceforge.net"><img src="images/sflogo.png" width="88" height="31" border="0" alt="SourceForge.net Logo"/></a>
<div class="vspace"></div>
</div>
            </div>
            <div id='col-right'>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Build QuantLib Calc Addin on Windows and/or Linux </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="center"><small><a href="tutorials.html">back to tutorials index</a></small></div><table border="1" bgcolor="lightsteelblue">
<tr>
<td><b>NB:</b> For the current release of QuantLibAddin 1.14.0, the LibreOffice build has not been updated. The documentation on this page is out of date and relates to an older build of the LibreOffice addin. <a href="#" onclick="location.href='mai'+'lto:'+'qua'+'nt'+'lib'+'-u'+'ser'+'s@'+'lis'+'ts'+'.sf'+'.n'+'et'; return false;">quant<span style="display: none;">.nosp@m.</span>lib-<span style="display: none;">.nosp@m.</span>users<span style="display: none;">.nosp@m.</span>@lis<span style="display: none;">.nosp@m.</span>ts.sf<span style="display: none;">.nosp@m.</span>.net</a>.  </td></tr>
</table>
<h1><a class="anchor" id="build_calc_overview"></a>
Overview</h1>
<p>This document summarizes special considerations for compiling QuantLibAddin for OpenOffice.org Calc. The first section gives a general overview relevant to Windows and Linux, this is followed by additional notes specific to compiling on Linux. For further help or to offer feedback on this document send email to <a href="#" onclick="location.href='mai'+'lto:'+'qua'+'nt'+'lib'+'-u'+'ser'+'s@'+'lis'+'ts'+'.sf'+'.n'+'et'; return false;">quantlib-users@lists.sf.net</a>.</p>
<h1><a class="anchor" id="build_calc_status"></a>
Project Status</h1>
<p>The QuantLib Calc Addin is a working prototype, supporting a dozen spreadsheet functions, enough to instantiate some market data objects and then create and price an option. The release includes an example spreadsheet which demonstrates this.</p>
<p>The design of the QuantLibAddin interface is platform independent and the Calc Addin could be extended to include all of the functionality that is currently supported by QuantLibXL.</p>
<h1><a class="anchor" id="build_calc_compile"></a>
Compiling QuantLibAddin for OpenOffice.org Calc</h1>
<h2><a class="anchor" id="Prerequisites"></a>
Prerequisites</h2>
<p>Before compiling an Addin for OOo Calc you'll need to install the <a href="http://download.openoffice.org/2.4.0/sdk.html">OpenOffice.org Software Development Kit (OOo SDK)</a>. Make sure you get the version of the OOo SDK that corresponds to the version of OOo which you have installed. QuantLibAddin 1.14.0 has been tested against OOo/OOo SDK version 2.4.0.</p>
<h2><a class="anchor" id="build_calc_env"></a>
Environment Variables</h2>
<p>After installing the above, ensure that the following environment variables are set:</p>
<p><code> <b>variable:</b> OFFICE_PROGRAM_PATH<br />
 <b>description:</b> location of OOo program directory<br />
 <b>value on Linux:</b> /usr/openoffice.org/program<br />
 <b>value on Windows:</b> C:\Program Files\OpenOffice.org 2.4\program<br />
</code></p>
<p><code><b>variable:</b> OFFICE_SDK_PATH<br />
 <b>description:</b> location of OOo SDK<br />
 <b>value on Linux:</b> /usr/openoffice.org/sdk<br />
 <b>value on Windows:</b> C:\OpenOffice.org_2.4_SDK<br />
</code></p>
<p><code><b>variable:</b> PATH<br />
 <b>description:</b> Must include location of OOo SDK bin directory<br />
 <b>value on Linux:</b> /usr/openoffice.org/sdk/linux/bin<br />
 <b>value on Windows:</b> C:\OpenOffice.org_2.4_SDK\windows\bin<br />
 </code></p>
<h2><a class="anchor" id="build_calc_build"></a>
Build</h2>
<p>Below are the steps required to compile and install an Addin for OpenOffice.org Calc (Windows and Linux). These steps have been incorporated into the QuantLibAddin Calc makefiles for supported compilers/platforms.</p>
<ul>
<li><b>idlc</b> - Run OOo utility <b>idlc</b> to compile the idl (interface definition language) file QuantLibAddinCalc.idl into urd (UNO reflection data) file QuantLibAddinCalc.urd. The urd file comprises binary descriptions of the types in the Addin. </li>
<li><b>regmerge</b> - Run OOo utility <b>regmerge</b> to merge the urd file into rdb (registry database) file QuantLibAddinCalc.rdb. The rdb is used by OOo at runtime to infer the functionality available in the Addin. </li>
<li><b>cppumaker</b> - Run OOo utility <b>cppumaker</b> to generate the source code corresponding to the definitions in the rdb. </li>
<li><b>compile</b> - Compile the Addin, including the source generated above, plus the function implementation source code supplied for the Addin. The Addin is compiled into a shared library, i.e. <b>QuantLibAddinCalc-vc71-mt-1_14_0.dll</b> (Windows) or <b>libQuantLibAddinCalc-1.14.0.so</b> (Linux). </li>
<li><b>install</b> - Copy the Addin's shared library and registry database to the OOo program directory.</li>
</ul>
<p>One further step is required, the name of the registry database must be added to an OOo ini file in order to inform OOo of the location of the Addin. This step is not automated by the build process and must be performed manually:</p>
<ul>
<li>Go to the OOo program directory </li>
<li>In a text editor, open the unorc file (<code>unorc</code> on Linux, <code>unorc.ini</code> on Windows) </li>
<li>On the line for UNO_SERVICES, append the text <pre class="fragment">ORIGIN/QuantLibAddinCalc-vc71-mt-1_14_0.rdb
</pre> </li>
<li>On the line for UNO_TYPES, append the text <pre class="fragment">$ORIGIN/QuantLibAddinCalc-vc71-mt-1_14_0.rdb
</pre></li>
</ul>
<p>Once everything is in place, launch OOo Calc and hit <code>Ctrl-F2</code> to bring up the list of available functions, if all has gone well the QuantLibAddin functions should appear. The example workbook is </p><pre class="fragment">QuantLibAddin\Clients\Calc\Option.ods
</pre><h1><a class="anchor" id="build_calc_windows"></a>
Compiling Under Windows</h1>
<p>Note that to compile QuantLibAddin for Calc under Windows, you need VC7 (Microsoft Visual C++ 2003). Use solution <code>QuantLibAddinCalc_vc7.sln</code>, configuration <code>Release</code>. You will need to configure VC7 so that the paths it searches for executables include</p>
<pre class="fragment">C:\Program Files\OpenOffice.org_2.4_SDK\windows\bin
C:\Program Files\OpenOffice.org 2.4\program
</pre><h1><a class="anchor" id="build_calc_linux"></a>
Additional Considerations for Linux Builds</h1>
<h2><a class="anchor" id="build_calc_compiler"></a>
Compiler</h2>
<p>OOo ships with its own versions of certain C/C++ runtime libraries, these are installed to the OOo program directory and OOo loads these in preference to those installed on your system. Therefore the Calc Addin should be compiled with the same version of gcc that was used to compile OOo itself. For a listing of the OOo compiler versions by environment see <a href="http://wiki.services.openoffice.org/wiki/Compiler_versions_used_by_port_maintainers_and_release_engineers">http://wiki.services.openoffice.org/wiki/Compiler_versions_used_by_port_maintainers_and_release_engineers</a>.</p>
<p>Some additional detail on this issue is available at the following link on the OOo website: <a href="http://udk.openoffice.org/common/man/draft/gccincompatibility.html">Coping with GCC Incompatibilities</a></p>
<h2><a class="anchor" id="build_calc_compiler_build"></a>
Building gcc</h2>
<p>If the required version of gcc is not shipped with your distribution then you'll need to install it alongside your existing version of gcc. If you're lucky, the required version of gcc may be available as a binary installation for your distro. More likely you will need to build gcc from source. The gcc source tarballs can be acquired from one of the <a href="http://gcc.gnu.org/mirrors.html">gcc mirror sites.</a></p>
<p>See the following document describing the procedure for maintaining multiple versions of gcc concurrently: <a href="http://www.tellurian.com.au/whitepapers/multiplegcc.php">Installing and Using Multiple Versions of GCC</a>. See also the standard gcc installation notes: <a href="http://gcc.gnu.org/install">Installing GCC</a>.</p>
<h2><a class="anchor" id="build_calc_linux_build"></a>
Building QuantLibAddin for OOo Calc on Linux</h2>
<p>You need to build and install the following projects:</p>
<ul>
<li>QuantLib </li>
<li>log4cxx </li>
<li>ObjectHandler </li>
<li>QuantLibAddin</li>
</ul>
<p>If you have installed a second version of gcc as described above then you need to pass the relevant arguments to configure e.g:</p>
<pre class="fragment">./configure \
CXX=/usr/local/gcc/[version]/bin/g++ \
CPP=/usr/local/gcc/[version]/bin/cpp
</pre><p>... where [version] is the version number of gcc required by Calc on your platform.</p>
<p><b>NB</b> If you intend to debug QuantLibAddin with the gdb command line debugger, then you should also use the compile flag <code>-gdwarf-2</code> as explained in this FAQ item: <a class="el" href="faq.html#faq_item_debuglinux">6.2 How do I debug a QuantLibAddin Linux executable at the command line?</a></p>
<h2><a class="anchor" id="build_calc_libs"></a>
Shared Libraries</h2>
<p>At startup OOo loads the QuantLibAddin library, which in turn has a runtime dependency on the shared libraries for QuantLib and ObjectHandler.</p>
<p>The QuantLibAddin Calc binary is always installed to the OOo program directory /usr/lib/openoffice.org2.0/program. QuantLib and ObjectHandler are by default installed to /usr/local/lib, though you may choose to override this when configuring these applications.</p>
<p>You need to configure your system to tell your program loader the location of all relevant shared libraries. One way to accomplish this is to add the relevant paths to the file /etc/ld.so.conf, which tells the loader where to search for shared libraries. After editing this file remember to run <code>ldconfig</code> (as root, no arguments) to refresh the linker cache.</p>
<p>For additional information on managing shared libraries, consult the <a href="http://www.dwheeler.com/program-library/Program-Library-HOWTO/index.html">Program Library HOWTO</a>.</p>
<div align="center"><small><a href="tutorials.html">back to tutorials index</a></small></div> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
            </div>
            <div class='clearfix'></div>
<div id="footer">SourceForge logo copyright &#169; Open Source Technology Group<br>reposit logo <a href="http://www.reposit.be">copyright &#169; 2015 reposit Ltd Dublin</a><br>all other content <a href="license.html">copyright &#169; 2004-20015 The QuantLib Group</a></div>
        </div>
        <div class='clearfix'></div>
    </div>
    <div class='clearfix'></div>
</body>
</html>
