<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>QuantLibAddin: Build QuantLibXL From Source Code</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="tabs.css">
    <link rel="stylesheet" href="ql.css">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id='wrapper'>
        <div id='header'>
        <div id='floatleft'><a class="imglink" href="index.html"><img src="images/logo_qla.jpg" width="180" height="72" border="0" alt="QuantLibAddin Logo"/></a></div>
        <div id='floatright'><a class="imglink" href="http://quantlib.org"><img src="images/logo_ql.jpg" width="130" height="82" border="0" alt="QuantLib Logo"/></a></div>
        </div>
        <div id='content'>
            <div id='col-left'>
            <div id="version">Version 1.20.0</div>
                <div id='sidebar'>
<ul>
<li class="menuheader"><a href="index.html">Home</a></li>
<li><a href="installation.html">Installation</a></li>
<li><a href="design.html">Design</a></li>
<li><a href="history.html">History</a></li>
<li><a href="license.html">License</a></li>
<li><a href="people.html">People</a></li>
<li><a href="faq.html">FAQ</a></li>
<li class="menuheader"><a href="functional.html">Functional<br>Documentation</a></li>
<li><a href="manual.html">Manual</a></li>
<li><a href="allfunctions.html">Functions</a></li>
<li><a href="categories.html">Categories</a></li>
<li><a href="enums.html">Enumerations</a></li>
<li class="menuheader"><a href="technical.html">Technical<br>Documentation</a></li>
<li><a href="tutorials.html">Tutorials</a></li>
<li><a href="annotated.html">Classes</a></li>
<li><a href="hierarchy.html">Hierarchy</a></li>
<li><a href="files.html">Files</a></li>
<li><a href="examples.html">Examples</a></li>
</ul>
                </div>
<div class="logo">
<div class="vspace"></div>
<a href="http://www.reposit.be" id="reposit_logo"></a>
<div class="vspace"></div>
<a class="imglink" href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=12470&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo"/></a>
<div class="vspace"></div>
</div>
            </div>
            <div id='col-right'>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Build QuantLibXL From Source Code </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="center"><small><a href="tutorials.html">back to tutorials index</a></small></div><p>This document explains how to build QuantLibXL and its prerequisites from source code.</p>
<p>If you want a binary installation of the precompiled addin, go instead to the <a href="http://www.quantlibxl.org">QuantLibXL</a> web site.</p>
<p>For other tutorials which explain how to compile QuantLibAddin for platforms other than Microsoft Excel on Windows, return to the <a class="el" href="tutorials.html">Tutorials</a> index.</p>
<p><a class="el" href="build_qlxl.html#build_qlxl_builds">1 Choose a Build - Basic or Full</a> <br  />
<a class="el" href="build_qlxl.html#build_qlxl_prerequisites">2 Prerequisites</a> <br  />
<a class="el" href="build_qlxl.html#build_qlxl_directories">3 A Note on Directories</a> <br  />
<a class="el" href="build_qlxl.html#build_qlxl_source">4 Install the Source Code</a> <br  />
<a class="el" href="build_qlxl.html#build_qlxl_quantlibxl">5 Build QuantLibXL</a> <br  />
 </p>
<h1><a class="anchor" id="build_qlxl_builds"></a>
1 Choose a Build - Basic or Full</h1>
<p>This tutorial offers a choice of two builds as summarized below.</p>
<table class="doxtable">
<tr>
<td><b>Build</b></td><td><b>Description</b> </td></tr>
<tr>
<td>Full </td><td>This build performs autogeneration of QuantLibXL source code. Requires you to install Python and gensrc. You can enhance/customize this build by editing addin XML metadata and re-running gensrc.  </td></tr>
<tr>
<td>Basic </td><td>For this build, the autogenerated source code has already been created for you, and is not recreated during the build. Does not require Python or gensrc. To customize/enhance this build you would need manually to edit the autogenerated C++ source files.  </td></tr>
</table>
<h1><a class="anchor" id="build_qlxl_prerequisites"></a>
2 Prerequisites</h1>
<p>Before proceeding to compile the source code, consult the documents below.</p>
<h2><a class="anchor" id="build_qlxl_conventions"></a>
2.1 Conventions</h2>
<p>See the following document regarding naming conventions in use for the project: <a class="el" href="conventions.html">Conventions</a></p>
<h2><a class="anchor" id="build_qlxl_boost"></a>
2.2 Boost</h2>
<p>QuantLibXL depends on Boost. Any recent version of Boost should be OK. You will need the compiled Boost libraries, the Boost header files alone are not sufficient.</p>
<h2><a class="anchor" id="build_qlxl_python"></a>
2.3 Python 2.x</h2>
<p>For the <b>Full</b> build, some code is autogenerated by gensrc, which is a Python script. Before rebuilding QuantLibXL you need to have Python 2.x installed on your machine. Here is the link to the Python website: <a href="http://www.python.org/">http://www.python.org/</a>.</p>
<p>If Python is installed on your machine so that .py files are associated with the Python executable, then the gensrc scripts should build OK with no modification required.</p>
<p>Otherwise, after you install gensrc (below), you might need to edit these files...</p>
<pre class="fragment">    ObjectHandler\gensrc\Makefile.vc
    QuantLibAddin\gensrc\Makefile.vc
</pre><p>...and set the PYTHON variable equal to the location of the Python executable on your machine, e.g:</p>
<pre class="fragment">    PYTHON=C:\Python27\python.exe
</pre><h1><a class="anchor" id="build_qlxl_directories"></a>
3 A Note on Directories</h1>
<p>You are now ready to proceed with the build. You need to install the following projects: </p><ul>
<li><a href="http://quantlib.org/">QuantLib</a> 1.20.0 - The core C++ analytics library </li>
<li><a href="http://www.objecthandler.org">ObjectHandler</a> 1.20.0 - An object repository </li>
<li>log4cxx 0.10.0f12 - A logging framework, used by ObjectHandler </li>
<li><a href="http://www.quantlibaddin.org">QuantLibAddin</a> 1.20.0 - Addins for QuantLib functionality </li>
<li><a href="http://www.quantlibxl.org">QuantLibXL</a> 1.20.0 - The Excel implementation of QuantLibAddin </li>
<li><a href="http://www.gensrc.org">gensrc</a> 1.20.0 - A Python application for autogenerating source code (Full build only)</li>
</ul>
<p>The build uses a VC solution (see below) which allows QuantLibXL and its prerequisites to be compiled together. The solution uses relative pathnames to refer to the prerequisite projects QuantLib, log4cxx, ObjectHandler, QuantLibAddin, and (for the Full build only) gensrc. In order for this to work, these projects must reside side by side in the directory tree, and the name of each project's parent directory must not include the version number (e.g. <code>QuantLib</code> not <code>QuantLib-1.20.0</code>).</p>
<p>Create a new empty folder on your hard drive to serve as the root directory for the build. You can use any path, for purposes of this tutorial the build directory is <code>C:\build_ql_1_20_0</code>. As described below you should copy all of the required source code zip files to that directory and then unzip them in place. After unzipping QuantLib you must manually rename the target directory, removing the <code>1.20.0</code> suffix from the directory name. After all of the source code is unzipped you should have the following directory structure: </p><pre class="fragment">C:\build_ql_1_20_0\gensrc (required only for the Full build)
C:\build_ql_1_20_0\log4cxx
C:\build_ql_1_20_0\ObjectHandler
C:\build_ql_1_20_0\QuantLib
C:\build_ql_1_20_0\QuantLibAddin
C:\build_ql_1_20_0\QuantLibXL
</pre><h1><a class="anchor" id="build_qlxl_source"></a>
4 Install the Source Code</h1>
<p>Go to the <a href="https://bintray.com/quantlib/releases/QuantLib/1.20#files">QuantLib downloads page</a>.</p>
<p>Download <code>QuantLib-1.20.0.zip</code> and uncompress the package to <code>C:\build_ql_1_20_0\QuantLib</code>.</p>
<p>Go to the <a href="https://bintray.com/quantlib/releases/QuantLibXL/1.20#files">QuantLibXL downloads page</a>.</p>
<p>Download <code>log4cxx-0.10.0f12.zip</code> and uncompress the package to <code>C:\build_ql_1_20_0\log4cxx</code>.</p>
<p>Download <code>ObjectHandler-1.20.0.zip</code> and uncompress the package to <code>C:\build_ql_1_20_0\ObjectHandler</code>.</p>
<p>Download <code>QuantLibAddin-1.20.0.zip</code> and uncompress the package to <code>C:\build_ql_1_20_0\QuantLibAddin</code>.</p>
<p>Download <code>QuantLibXL-src-1.20.0.zip</code> and uncompress the package to <code>C:\build_ql_1_20_0\QuantLibXL</code>.</p>
<p><b>Full</b> build only - download <code>gensrc-1.20.0.zip</code> and uncompress the package to <code>C:\build_ql_1_20_0\gensrc</code>.</p>
<h1><a class="anchor" id="build_qlxl_quantlibxl"></a>
5 Build QuantLibXL</h1>
<p><b>Basic</b> build - open VC solution <code>QuantLibXL\QuantLibXL_basic.sln</code>.</p>
<p><b>Full</b> build - open VC solution <code>QuantLibXL\QuantLibXL_full.sln</code>.</p>
<p>Choose configuration <code>Release (static runtime)</code> and do <code>Build | Build Solution</code>.</p>
<p>The build process creates the QuantLibAddin XLL file <code>QuantLibXL\xll\QuantLibXL-vc??-mt-s-1_20_0.xll</code>. Instructions for loading the addin are provided in the QuantLibXL installation document: <a href="http://www.quantlibxl.org/installation.html">http://www.quantlibxl.org/installation.html</a></p>
<div align="center"><small><a href="tutorials.html">back to tutorials index</a></small></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
            </div>
            <div class='clearfix'></div>
<div id="footer">SourceForge logo copyright &#169; Open Source Technology Group<br>reposit logo <a href="http://www.reposit.be">copyright &#169; 2015 reposit Ltd Dublin</a><br>all other content <a href="license.html">copyright &#169; 2004-20015 The QuantLib Group</a></div>
        </div>
        <div class='clearfix'></div>
    </div>
    <div class='clearfix'></div>
</body>
</html>
