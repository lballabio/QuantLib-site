<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>QuantLibAddin: Expose QuantLib Enumerations to QuantLibXL</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="tabs.css">
    <link rel="stylesheet" href="ql.css">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id='wrapper'>
        <div id='header'>
        <div id='floatleft'><a class="imglink" href="index.html"><img src="images/logo_qla.jpg" width="180" height="72" border="0" alt="QuantLibAddin Logo"/></a></div>
        <div id='floatright'><a class="imglink" href="http://quantlib.org"><img src="images/logo_ql.jpg" width="130" height="82" border="0" alt="QuantLib Logo"/></a></div>
        </div>
        <div id='content'>
            <div id='col-left'>
            <div id="version">Version 1.20.0</div>
                <div id='sidebar'>
<ul>
<li class="menuheader"><a href="index.html">Home</a></li>
<li><a href="installation.html">Installation</a></li>
<li><a href="design.html">Design</a></li>
<li><a href="history.html">History</a></li>
<li><a href="license.html">License</a></li>
<li><a href="people.html">People</a></li>
<li><a href="faq.html">FAQ</a></li>
<li class="menuheader"><a href="functional.html">Functional<br>Documentation</a></li>
<li><a href="manual.html">Manual</a></li>
<li><a href="allfunctions.html">Functions</a></li>
<li><a href="categories.html">Categories</a></li>
<li><a href="enums.html">Enumerations</a></li>
<li class="menuheader"><a href="technical.html">Technical<br>Documentation</a></li>
<li><a href="tutorials.html">Tutorials</a></li>
<li><a href="annotated.html">Classes</a></li>
<li><a href="hierarchy.html">Hierarchy</a></li>
<li><a href="files.html">Files</a></li>
<li><a href="examples.html">Examples</a></li>
</ul>
                </div>
<div class="logo">
<div class="vspace"></div>
<a href="http://www.reposit.be" id="reposit_logo"></a>
<div class="vspace"></div>
<a class="imglink" href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=12470&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo"/></a>
<div class="vspace"></div>
</div>
            </div>
            <div id='col-right'>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Expose QuantLib Enumerations to QuantLibXL </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="center"><small>&copy; 2011 Andrew Downes</small></div> <div align="center"><small><a href="tutorials.html">back to tutorials index</a></small></div><p>This document explains how to expose additional QuantLib enumerated types to Excel. As a prerequisite it is assumed that you have already compiled QuantLibXL from source code using the Full build documented in the tutorial <a class="el" href="build_qlxl.html">Build QuantLibXL From Source Code</a>.</p>
<p><a class="el" href="extend_enum_tutorial.html#extend2_enum">1 The Enumeration</a> <br  />
<a class="el" href="extend_enum_tutorial.html#extend2_enum_add">2 Adding the Enumeration to QuantLibXL</a> <br  />
<a class="el" href="extend_enum_tutorial.html#extend2_enum_use">3 Using the Enumeration in QuantLibXL</a> <br  />
<a class="el" href="extend_enum_tutorial.html#extend2_enum_flag">4 The Constructor Flag</a> <br  />
 </p>
<h1><a class="anchor" id="extend2_enum"></a>
1 The Enumeration</h1>
<p>In this example we use a new, trivial, example of an enumerated type. We assume the code for the enumeration is contained in the file:</p>
<pre class="fragment">QuantLib\ql\newfiles\newenums.hpp
</pre><p>This file is added to the root directory of the QuantLib project. The code for the enumeration is below:</p>
<pre class="fragment">#ifndef new_enums_h
#define new_enums_h
namespace QuantLib {
enum NewEnumeration {
NO_NEW_ENUMERATION,
ENUM_VALUE_1,
ENUM_VALUE_2
};
} // namespace
#endif
</pre><h1><a class="anchor" id="extend2_enum_add"></a>
2 Adding the Enumeration to QuantLibXL</h1>
<p>Open the file:</p>
<pre class="fragment">QuantLibAddin\gensrc\metadata\enumerations\enumeratedtypes.xml
</pre><p>Between &lt;EnumeratedTypeGroups&gt; and &lt;/EnumeratedTypeGroups&gt; add the code:</p>
<pre class="fragment">&lt;EnumeratedTypeGroup type='QuantLib::NewEnumeration'&gt;
&lt;includeFile&gt;oh/enumerations/typefactory.hpp&lt;/includeFile&gt;
&lt;constructor&gt;true&lt;/constructor&gt;
&lt;EnumeratedTypes&gt;
&lt;EnumeratedType&gt;
&lt;string&gt;NO_NEW_ENUMERATION&lt;/string&gt;
&lt;value&gt;QuantLib::NO_NEW_ENUMERATION&lt;/value&gt;
&lt;/EnumeratedType&gt;
&lt;EnumeratedType&gt;
&lt;string&gt;ENUM_VALUE_1&lt;/string&gt;
&lt;value&gt;QuantLib::ENUM_VALUE_1&lt;/value&gt;
&lt;/EnumeratedType&gt;
&lt;EnumeratedType&gt;
&lt;string&gt;ENUM_VALUE_2&lt;/string&gt;
&lt;value&gt;QuantLib::ENUM_VALUE_2&lt;/value&gt;
&lt;/EnumeratedType&gt;
&lt;/EnumeratedTypes&gt;
&lt;/EnumeratedTypeGroup&gt;
</pre><p>The line &lt;constructor&gt;true&lt;/constructor&gt; will be discussed in more detail in the final section, for all <a class="el" href="namespace_quant_lib.html">QuantLib</a> enumerations that you wish to expose to Excel the line should remain as above. Edit the file</p>
<pre class="fragment">QuantLibAddin\gensrc\metadata\types\types.xml
</pre><p>and add the new data type NewEnumeration:</p>
<pre class="fragment">&lt;root&gt;
&lt;DataTypes&gt;
&lt;DataType defaultSuperType='enumeration'&gt;QuantLib::Average::Type&lt;/DataType&gt;
...
&lt;DataType defaultSuperType='enumeration'&gt;QuantLib::NewEnumeration&lt;/DataType&gt;
...
&lt;DataType defaultSuperType='underlyingClass'&gt;QuantLib::Leg&lt;/DataType&gt;
&lt;/DataTypes&gt;
&lt;/root&gt;
</pre><p>Edit the file </p><pre class="fragment">QuantLibAddin\gensrc\stubs\stub.enum.types
</pre><p> and add the file containing the new enumeration:</p>
<pre class="fragment">#include &lt;qlo/qladdindefines.hpp&gt;
...
#include &lt;ql/newfiles/newenums.hpp&gt;
</pre><h1><a class="anchor" id="extend2_enum_use"></a>
3 Using the Enumeration in QuantLibXL</h1>
<p>To use this enumeration in a function/constructor call from excel, add the parameter to the function/constructor in the appropriate .xml file by using:</p>
<pre class="fragment">&lt;Member name='qlMyFunction' type='QuantLib::MyClass'&gt;
&lt;description&gt;function description&lt;/description&gt;
&lt;libraryFunction&gt;myFunction&lt;/libraryFunction&gt;
&lt;SupportedPlatforms&gt;
&lt;SupportedPlatform name='Excel' calcInWizard='false'/&gt;
&lt;/SupportedPlatforms&gt;
&lt;ParameterList&gt;
&lt;Parameters&gt;
&lt;Parameter name='NewEnum' exampleValue='ENUM_VALUE_1'&gt;
&lt;type&gt;QuantLib::NewEnumeration&lt;/type&gt;
&lt;tensorRank&gt;scalar&lt;/tensorRank&gt;
&lt;description&gt;new enumeration&lt;/description&gt;
&lt;/Parameter&gt;
&lt;/Parameters&gt;
&lt;/ParameterList&gt;
&lt;ReturnValue&gt;
&lt;type&gt;double&lt;/type&gt;
&lt;tensorRank&gt;scalar&lt;/tensorRank&gt;
&lt;/ReturnValue&gt;
&lt;/Member&gt;
</pre><p>The enumeration can now be used in excel by entering a string. For the above example we write:</p>
<pre class="fragment">=qlMyFunction(ENUM_VALUE_1)
</pre><h1><a class="anchor" id="extend2_enum_flag"></a>
4 The Constructor Flag</h1>
<p>As mentioned, for all QuantLib enumerated types that you wish to expose to Excel the &lt;constructor&gt; tag should remain set to true. This associates the string <code>ENUM_VALUE_1</code> in Excel with the <a class="el" href="namespace_quant_lib.html">QuantLib</a> type</p>
<pre class="fragment">QuantLib::NewEnumeration(QuantLib::ENUM_VALUE_1)
</pre><p>However, you may wish to associate a string in Excel directly with a QuantLib class. An example of this is given by currency inputs to functions, which can be written simply as (for example) <code>AUD</code>, rather than going through the process of constructing an Australian dollar currency class.</p>
<p>To achieve a similar result, set the &lt;constructor&gt; tag to false. In the above example, this would associate the string <code>ENUM_VALUE_1</code> in Excel with the QuantLib type QuantLib::ENUM_VALUE_1 - the string in the &lt;string&gt; tag is replaced directly with the type in the value tag. Hence, as in the currency example, if you wanted the string AUD to give an AUDCurrency class, we would set the &lt;constructor&gt; tag to false, set the &lt;string&gt; tag to AUD and the value tag to QuantLib::AUDCurrency().</p>
<div align="center"><small><a href="tutorials.html">back to tutorials index</a></small></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
            </div>
            <div class='clearfix'></div>
<div id="footer">SourceForge logo copyright &#169; Open Source Technology Group<br>reposit logo <a href="http://www.reposit.be">copyright &#169; 2015 reposit Ltd Dublin</a><br>all other content <a href="license.html">copyright &#169; 2004-20015 The QuantLib Group</a></div>
        </div>
        <div class='clearfix'></div>
    </div>
    <div class='clearfix'></div>
</body>
</html>
