<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>QuantLibAddin: Garbage Collection</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="tabs.css">
    <link rel="stylesheet" href="ql.css">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id='wrapper'>
        <div id='header'>
        <div id='floatleft'><a class="imglink" href="index.html"><img src="images/logo_qla.jpg" width="180" height="72" border="0" alt="QuantLibAddin Logo"/></a></div>
        <div id='floatright'><a class="imglink" href="http://quantlib.org"><img src="images/logo_ql.jpg" width="130" height="82" border="0" alt="QuantLib Logo"/></a></div>
        </div>
        <div id='content'>
            <div id='col-left'>
            <div id="version">Version 1.22.0</div>
                <div id='sidebar'>
<ul>
<li class="menuheader"><a href="index.html">Home</a></li>
<li><a href="installation.html">Installation</a></li>
<li><a href="design.html">Design</a></li>
<li><a href="history.html">History</a></li>
<li><a href="license.html">License</a></li>
<li><a href="people.html">People</a></li>
<li><a href="faq.html">FAQ</a></li>
<li class="menuheader"><a href="functional.html">Functional<br>Documentation</a></li>
<li><a href="manual.html">Manual</a></li>
<li><a href="allfunctions.html">Functions</a></li>
<li><a href="categories.html">Categories</a></li>
<li><a href="enums.html">Enumerations</a></li>
<li class="menuheader"><a href="technical.html">Technical<br>Documentation</a></li>
<li><a href="tutorials.html">Tutorials</a></li>
<li><a href="annotated.html">Classes</a></li>
<li><a href="hierarchy.html">Hierarchy</a></li>
<li><a href="files.html">Files</a></li>
<li><a href="examples.html">Examples</a></li>
</ul>
                </div>
<div class="logo">
<div class="vspace"></div>
<a href="http://www.reposit.be" id="reposit_logo"></a>
<div class="vspace"></div>
</div>
            </div>
            <div id='col-right'>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Garbage Collection </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="center"><small><a href="manual.html">back to reference manual index</a></small></div><h1><a class="anchor" id="gc_overview"></a>
Overview</h1>
<p>The Excel implementation of ObjectHandler supports function <a class="el" href="func_garbagecollection.html#ohRepositoryCollectGarbage">ohRepositoryCollectGarbage</a> which can be called to cull objects that have been orphaned in the repository by events such as the closing of a workbook.</p>
<p>A cell formula invokes the constructor of an object, causing that object to be added to the repository. The object is assigned an ID which is returned to the calling cell, allowing the object to be accessed, e.g. the ID of one object could be passed as an input to the constructor of another.</p>
<p>An object persists in the repository even after the formula which instantiated the object is deleted - this happens, for example, when a workbook is closed. The object is not lost, its ID can still be retrieved and used to access the object.</p>
<p>However the object is likely redundant and a mechanism for cleaning it up is desirable. Function <a class="el" href="func_garbagecollection.html#ohRepositoryCollectGarbage">ohRepositoryCollectGarbage</a> iterates through all the objects in the repository and culls those objects which have been orphaned by the deletion of the calling cell.</p>
<h1><a class="anchor" id="gc_diagnostics"></a>
Diagnostics</h1>
<ul>
<li><a class="el" href="func_objects.html#ohObjectCallerAddress">ohObjectCallerAddress</a> may be called on an object ID to retrieve the address of the cell in which the object was instantiated. If this address comes back as a #REF it indicates that the object is orphaned and will be culled next time <a class="el" href="func_garbagecollection.html#ohRepositoryCollectGarbage">ohRepositoryCollectGarbage</a> is called. </li>
<li><a class="el" href="func_garbagecollection.html#ohRepositoryLogAllObjects">ohRepositoryLogAllObjects</a> dumps the complete contents of the ObjectHandler repository to the log file, this is followed by a summary of all of the references maintained by ObjectHandler in support of garbage collection.</li>
</ul>
<h1><a class="anchor" id="gc_acknowledgements"></a>
Acknowledgements</h1>
<p>ObjectHandler's garbage collection functionality is an implementation of a technique presented in <a href="http://eu.wiley.com/WileyCDA/WileyTitle/productCd-0470027975.html">Excel Add-in Development in C/C++: Applications in Finance</a> by Steve Dalton. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
            </div>
            <div class='clearfix'></div>
<div id="footer">SourceForge logo copyright &#169; Open Source Technology Group<br>reposit logo <a href="http://www.reposit.be">copyright &#169; 2015 reposit Ltd Dublin</a><br>all other content <a href="license.html">copyright &#169; 2004-20015 The QuantLib Group</a></div>
        </div>
        <div class='clearfix'></div>
    </div>
    <div class='clearfix'></div>
</body>
</html>
