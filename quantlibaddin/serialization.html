<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>QuantLibAddin: Serialization Demo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="tabs.css">
    <link rel="stylesheet" href="ql.css">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id='wrapper'>
        <div id='header'>
        <div id='floatleft'><a class="imglink" href="index.html"><img src="images/logo_qla.jpg" width="180" height="72" border="0" alt="QuantLibAddin Logo"/></a></div>
        <div id='floatright'><a class="imglink" href="http://quantlib.org"><img src="images/logo_ql.jpg" width="130" height="82" border="0" alt="QuantLib Logo"/></a></div>
        </div>
        <div id='content'>
            <div id='col-left'>
            <div id="version">Version 1.21.0</div>
                <div id='sidebar'>
<ul>
<li class="menuheader"><a href="index.html">Home</a></li>
<li><a href="installation.html">Installation</a></li>
<li><a href="design.html">Design</a></li>
<li><a href="history.html">History</a></li>
<li><a href="license.html">License</a></li>
<li><a href="people.html">People</a></li>
<li><a href="faq.html">FAQ</a></li>
<li class="menuheader"><a href="functional.html">Functional<br>Documentation</a></li>
<li><a href="manual.html">Manual</a></li>
<li><a href="allfunctions.html">Functions</a></li>
<li><a href="categories.html">Categories</a></li>
<li><a href="enums.html">Enumerations</a></li>
<li class="menuheader"><a href="technical.html">Technical<br>Documentation</a></li>
<li><a href="tutorials.html">Tutorials</a></li>
<li><a href="annotated.html">Classes</a></li>
<li><a href="hierarchy.html">Hierarchy</a></li>
<li><a href="files.html">Files</a></li>
<li><a href="examples.html">Examples</a></li>
</ul>
                </div>
<div class="logo">
<div class="vspace"></div>
<a href="http://www.reposit.be" id="reposit_logo"></a>
<div class="vspace"></div>
</div>
            </div>
            <div id='col-right'>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Serialization Demo </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="center"><small><a href="tutorials.html">back to tutorials index</a></small></div><p>This document explains how to build an environment supporting export/import from/to Excel/C++ on Windows/Linux.</p>
<p>For the Excel portions of this tutorial you can use either the QuantLibXL Addin that was delivered by the binary installer, or one that you compile yourself using the tutorial <a class="el" href="build_qlxl.html">Build QuantLibXL From Source Code</a>.</p>
<p>For the C++ portions of this tutorial you must compile the QuantLibAddin C++ environment as described in tutorial <a class="el" href="build_cpp.html">Build A QuantLibAddin C++ Environment on Windows and/or Linux</a>.</p>
<p>Different versions of Boost create serialization files in different formats. If the application that imports the XML is compiled against a different version of Boost than the application that exported the XML, then the import fails with <code>stream error</code>. The export files created for this demo were generated from binaries that were compiled against Boost 1.35.0. The binary release of QuantLibXL was compiled against Boost 1.35.0. If you're using a different version of Boost then you need to re-export the demo files before attempting the import.</p>
<dl>
<dt><a class="el" href="serialization.html#serialization_windows">1 Windows</a> </dt>
<dd><dl>
<dt><a class="el" href="serialization.html#serialization_win_excel">1.1 Excel</a> </dt>
<dd><dl>
<dt><a class="el" href="serialization.html#serialization_win_excel_export">1.1.1 Export</a> </dt>
<dd></dd>
<dt><a class="el" href="serialization.html#serialization_win_excel_import">1.1.2 Import</a> </dt>
<dd></dd>
</dl>
</dd>
<dt><a class="el" href="serialization.html#serialization_win_cpp">1.2 C++</a> </dt>
<dd><dl>
<dt><a class="el" href="serialization.html#serialization_win_cpp_export">1.2.1 Export</a> </dt>
<dd></dd>
<dt><a class="el" href="serialization.html#serialization_win_cpp_import">1.2.2 Import</a> </dt>
<dd></dd>
</dl>
</dd>
</dl>
</dd>
<dt><a class="el" href="serialization.html#serialization_linux">2 Linux</a> </dt>
<dd><dl>
<dt><a class="el" href="serialization.html#serialization_linux_cpp">2.1 C++</a> </dt>
<dd><dl>
<dt><a class="el" href="serialization.html#serialization_linux_cpp_export">2.1.1 Export</a> </dt>
<dd></dd>
<dt><a class="el" href="serialization.html#serialization_linux_cpp_import">2.1.2 Import</a> </dt>
<dd></dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<h1><a class="anchor" id="serialization_windows"></a>
1 Windows</h1>
<h2><a class="anchor" id="serialization_win_excel"></a>
1.1 Excel</h2>
<h3><a class="anchor" id="serialization_win_excel_export"></a>
1.1.1 Export</h3>
<ul>
<li>Start Excel </li>
<li>Load VBA addin <code>QuantLibXL\framework2\QuantLibXL.xla</code>. The addin contains some startup code which should automatically load the following: <pre class="fragment">QuantLibXL\xll\QuantLibXL-vc90-mt-1_21_0.xll
QuantLibXL\framework2\addin\*.xla
</pre> </li>
<li>Invoke menu item <code>QuantLibXL | Load | Serialization Demo</code>. This loads the following: <pre class="fragment">QuantLibXL\framework2\workbooks\SerializationDemo.xls
</pre> </li>
<li>Hit <code>Ctrl-Alt-F9</code> </li>
<li>Confirm that a PV (on my machine, -39,396.95) is showing in cell <code>[SerializationDemo.xls]Swap!$F$14</code> </li>
<li>Activate sheet Serialization and invoke menu item <code>QuantLibXL | Serialization Demo | Export</code> </li>
<li>The following 2 files are produced: <pre class="fragment">QuantLibXL\framework2\xml\MarketData.xml
QuantLibXL\framework2\xml\Swap.xml
</pre></li>
</ul>
<h3><a class="anchor" id="serialization_win_excel_import"></a>
1.1.2 Import</h3>
<ul>
<li>Start Excel </li>
<li>Load VBA addin <code>QuantLibXL\framework2\QuantLibXL.xla</code>. The addin contains some startup code which should automatically load the following: <pre class="fragment">QuantLibXL\xll\QuantLibXL-vc90-mt-1_21_0.xll
QuantLibXL\framework2\addin\*.xla
</pre> </li>
<li>Invoke menu item <code>QuantLibXL | Load | Serialization Demo</code>. This loads the following: <pre class="fragment">QuantLibXL\framework2\workbooks\SerializationDemo.xls
</pre> </li>
<li>Set range <code>[SerializationDemo.xls]Settings!$H$15</code> to <code>Import</code> </li>
<li>Activate sheet Serialization and invoke menu item <code>QuantLibXL | Serialization Demo | Import</code> </li>
<li>The following 2 files are loaded: <pre class="fragment">QuantLibXL\framework2\xml\MarketData.xml
QuantLibXL\framework2\xml\Swap.xml
</pre> </li>
<li>Hit <code>Ctrl-Alt-F9</code> </li>
<li>Confirm that a PV (on my machine, -39,396.95) is showing in cell <code>[SerializationDemo.xls]Swap!$F$14</code></li>
</ul>
<p>If switching back and forth between import and export during a single Excel session you can use the command <code>QuantLibXL | ObjectHandler | Delete All Objects</code> to ensure that the ObjectHandler repository is empty. You can confirm this by ensuring that command <code>QuantLibXL | ObjectHandler | Object Count</code> returns zero.</p>
<h2><a class="anchor" id="serialization_win_cpp"></a>
1.2 C++</h2>
<h3><a class="anchor" id="serialization_win_cpp_export"></a>
1.2.1 Export</h3>
<p>Open a DOS prompt in directory <code>QuantLibAddin\Clients\CppSwapOut</code>. Invoke the executable. The output from the program should appear as follows: </p><pre class="fragment">Begin example program.
QuantLibAddin version = 1.21.0
ObjectHandler version = 1.21.0
SWAP PV = -39396.9
Example of serializing to/from a buffer:
XML =
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes" ?&gt;
&lt;!DOCTYPE boost_serialization&gt;
&lt;boost_serialization signature="serialization::archive" version="5"&gt;
&lt;object_list class_id="1" tracking_level="1" version="0" object_id="_0"&gt;
        &lt;count&gt;1&lt;/count&gt;
        &lt;item_version&gt;1&lt;/item_version&gt;
        &lt;item class_id="0" tracking_level="0" version="1"&gt;
                &lt;px class_id="166" tracking_level="1" version="0" object_id="_1"&gt;
                        &lt;ObjectId&gt;quote1&lt;/ObjectId&gt;
                        &lt;ClassName&gt;qlSimpleQuote&lt;/ClassName&gt;
                        &lt;Value&gt;1.23&lt;/Value&gt;
                        &lt;TickValue&gt;0&lt;/TickValue&gt;
                        &lt;Permanent&gt;0&lt;/Permanent&gt;
                        &lt;UserProperties class_id="234" tracking_level="0"
                            version="0"&gt;
                                &lt;count&gt;0&lt;/count&gt;
                                &lt;item_version&gt;0&lt;/item_version&gt;
                        &lt;/UserProperties&gt;
                &lt;/px&gt;
        &lt;/item&gt;
&lt;/object_list&gt;
&lt;/boost_serialization&gt;


INFO - log dump of object with ID = quote1

property = Permanent            value = 0
property = TickValue            value = 0
property = Value                value = 1.23
Permanent = false


End example program.
</pre><p>The program generates the XML export files <code>Swap.xml</code> and <code>MarketData.xml</code> in the current directory.</p>
<h3><a class="anchor" id="serialization_win_cpp_import"></a>
1.2.2 Import</h3>
<p>Open a DOS prompt in directory <code>QuantLibAddin\Clients\CppInstrumentIn</code>. Invoke batch file <code>price_Swap.bat</code>. The program loads the following 2 files: </p><pre class="fragment">QuantLibAddin\Clients\CppInstrumentIn\MarketData\MarketData.xml
QuantLibAddin\Clients\CppInstrumentIn\Models\Swap.xml
</pre><p> The output from the program should appear as follows: </p><pre class="fragment">QuantLibAddin\Clients\CppInstrumentIn&gt;InstrumentIn-vc90-mt.exe
    40546 Swap Swap.xml MarketData.xml
Begin example program.
QuantLibAddin version = 1.21.0
ObjectHandler version = 1.21.0
Instrument PV = -39396.9
End example program.
</pre><h1><a class="anchor" id="serialization_linux"></a>
2 Linux</h1>
<h2><a class="anchor" id="serialization_linux_cpp"></a>
2.1 C++</h2>
<h3><a class="anchor" id="serialization_linux_cpp_export"></a>
2.1.1 Export</h3>
<p><code>cd</code> to directory <code>QuantLibAddin/Clients/CppSwapOut</code> and execute program <code>swap_out</code>. The output from the program should appear as follows: </p><pre class="fragment">Begin example program.
QuantLibAddin version = 1.21.0
ObjectHandler version = 1.21.0
SWAP PV = -39396.9
Example of serializing to/from a buffer:
XML =
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes" ?&gt;
&lt;!DOCTYPE boost_serialization&gt;
&lt;boost_serialization signature="serialization::archive" version="5"&gt;
&lt;object_list class_id="1" tracking_level="1" version="0" object_id="_0"&gt;
        &lt;count&gt;1&lt;/count&gt;
        &lt;item_version&gt;1&lt;/item_version&gt;
        &lt;item class_id="0" tracking_level="0" version="1"&gt;
                &lt;px class_id="166" tracking_level="1" version="0" object_id="_1"&gt;
                        &lt;ObjectId&gt;quote1&lt;/ObjectId&gt;
                        &lt;ClassName&gt;qlSimpleQuote&lt;/ClassName&gt;
                        &lt;Value&gt;1.23&lt;/Value&gt;
                        &lt;TickValue&gt;0&lt;/TickValue&gt;
                        &lt;Permanent&gt;0&lt;/Permanent&gt;
                        &lt;UserProperties class_id="234" tracking_level="0"
                            version="0"&gt;
                                &lt;count&gt;0&lt;/count&gt;
                                &lt;item_version&gt;0&lt;/item_version&gt;
                        &lt;/UserProperties&gt;
                &lt;/px&gt;
        &lt;/item&gt;
&lt;/object_list&gt;
&lt;/boost_serialization&gt;


INFO - log dump of object with ID = quote1

property = Permanent            value = 0
property = TickValue            value = 0
property = Value                value = 1.23
Permanent = false


End example program.
</pre><p>The program generates the XML export files <code>Swap.xml</code> and <code>MarketData.xml</code> in the current directory.</p>
<h3><a class="anchor" id="serialization_linux_cpp_import"></a>
2.1.2 Import</h3>
<p>cd to directory <code>QuantLibAddin/Clients/CppInstrumentIn</code>. Invoke shell script <code>price_Swap.sh</code>. The program loads the following 2 files: </p><pre class="fragment">QuantLibAddin/Clients/CppInstrumentIn/MarketData/MarketData.xml
QuantLibAddin/Clients/CppInstrumentIn/Models/Swap.xml
</pre><p> The output from the program should appear as follows: </p><pre class="fragment">QuantLibAddin\Clients\CppInstrumentIn&gt;./instrument_in
    40546 Swap Swap.xml MarketData.xml
Begin example program.
QuantLibAddin version = 1.21.0
ObjectHandler version = 1.21.0
Instrument PV = -39396.9
End example program.
</pre><div align="center"><small><a href="tutorials.html">back to tutorials index</a></small></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
            </div>
            <div class='clearfix'></div>
<div id="footer">SourceForge logo copyright &#169; Open Source Technology Group<br>reposit logo <a href="http://www.reposit.be">copyright &#169; 2015 reposit Ltd Dublin</a><br>all other content <a href="license.html">copyright &#169; 2004-20015 The QuantLib Group</a></div>
        </div>
        <div class='clearfix'></div>
    </div>
    <div class='clearfix'></div>
</body>
</html>
