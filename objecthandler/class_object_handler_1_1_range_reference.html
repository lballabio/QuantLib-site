<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>ObjectHandler: ObjectHandler::RangeReference Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="tabs.css">
    <link rel="stylesheet" href="ql.css">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id='wrapper'>
        <div id='header'>
        <div id='floatleft'><a class="imglink" href="index.html"><img src="images/logo_oh.jpg" width="180" height="72" border="0" alt="ObjectHandler Logo"/></a></div>
        <div id='floatright'><a class="imglink" href="http://quantlib.org"><img src="images/logo_ql.jpg" width="130" height="82" border="0" alt="QuantLib Logo"/></a></div>
        </div>
        <div id='content'>
            <div id='col-left'>
            <div id="version">Version 1.20.0</div>
                <div id='sidebar'>
<ul>
<li class="menuheader"><a href="index.html">Home</a></li>
<li><a href="installation.html">Installation</a></li>
<li><a href="design.html">Design</a></li>
<li><a href="history.html">History</a></li>
<li><a href="license.html">License</a></li>
<li><a href="people.html">People</a></li>
<li class="menuheader"><a href="functional.html">Functional<br>Documentation</a></li>
<li><a href="manual.html">Manual</a></li>
<li><a href="allfunctions.html">Functions</a></li>
<li><a href="categories.html">Categories</a></li>
<li class="menuheader"><a href="technical.html">Technical<br>Documentation</a></li>
<li><a href="annotated.html">Classes</a></li>
<li><a href="hierarchy.html">Hierarchy</a></li>
<li><a href="files.html">Files</a></li>
<li><a href="examples.html">Examples</a></li>
</ul>
                </div>
<div class="logo">
<div class="vspace"></div>
<a href="http://www.reposit.be" id="reposit_logo"></a>
<div class="vspace"></div>
<a class="imglink" href="http://sourceforge.net"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=12470&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo"/></a>
<div class="vspace"></div>
</div>
            </div>
            <div id='col-right'>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_object_handler.html">ObjectHandler</a></li><li class="navelem"><a class="el" href="class_object_handler_1_1_range_reference.html">RangeReference</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#friends">Friends</a> &#124;
<a href="class_object_handler_1_1_range_reference-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ObjectHandler::RangeReference Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A utility class for parsing range references in string format.  
 <a href="class_object_handler_1_1_range_reference.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="rangereference_8hpp_source.html">ohxl/rangereference.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Structors and static members</div></td></tr>
<tr class="memitem:a84eebd82c4d354390601a1c9a3f65256"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_object_handler_1_1_range_reference.html#a84eebd82c4d354390601a1c9a3f65256">RangeReference</a> (const std::string &amp;address)</td></tr>
<tr class="memdesc:a84eebd82c4d354390601a1c9a3f65256"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor - initialize the <a class="el" href="class_object_handler_1_1_range_reference.html" title="A utility class for parsing range references in string format.">RangeReference</a> object.  <a href="class_object_handler_1_1_range_reference.html#a84eebd82c4d354390601a1c9a3f65256">More...</a><br /></td></tr>
<tr class="separator:a84eebd82c4d354390601a1c9a3f65256"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Operators and Comparisons</div></td></tr>
<tr class="memitem:a04a535869da4506c72e89ed43fdade6a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_object_handler_1_1_range_reference.html#a04a535869da4506c72e89ed43fdade6a">operator==</a> (const <a class="el" href="class_object_handler_1_1_range_reference.html">RangeReference</a> &amp;) const</td></tr>
<tr class="memdesc:a04a535869da4506c72e89ed43fdade6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test two <a class="el" href="class_object_handler_1_1_range_reference.html" title="A utility class for parsing range references in string format.">RangeReference</a> objects for equality.  <a href="class_object_handler_1_1_range_reference.html#a04a535869da4506c72e89ed43fdade6a">More...</a><br /></td></tr>
<tr class="separator:a04a535869da4506c72e89ed43fdade6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1948b5e060642803a214fc658bf3ff3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_object_handler_1_1_range_reference.html#ad1948b5e060642803a214fc658bf3ff3">contains</a> (const <a class="el" href="class_object_handler_1_1_range_reference.html">RangeReference</a> &amp;) const</td></tr>
<tr class="memdesc:ad1948b5e060642803a214fc658bf3ff3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine whether this range contains the given one.  <a href="class_object_handler_1_1_range_reference.html#ad1948b5e060642803a214fc658bf3ff3">More...</a><br /></td></tr>
<tr class="separator:ad1948b5e060642803a214fc658bf3ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a047d0f357974c73a6b47743414648a3a"><td class="memItemLeft" align="right" valign="top"><a id="a047d0f357974c73a6b47743414648a3a"></a>
std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator&lt;&lt;</b> (std::ostream &amp;, const <a class="el" href="class_object_handler_1_1_range_reference.html">RangeReference</a> &amp;)</td></tr>
<tr class="separator:a047d0f357974c73a6b47743414648a3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Error Messages</h2></td></tr>
<tr class="memitem:ac81a7cae2ffada5831320e99047682c1"><td class="memItemLeft" align="right" valign="top"><a id="ac81a7cae2ffada5831320e99047682c1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_object_handler_1_1_range_reference.html#ac81a7cae2ffada5831320e99047682c1">setErrorMessage</a> (const std::string &amp;<a class="el" href="class_object_handler_1_1_range_reference.html#a0e657785552ea70303e0f83d18b20c44">errorMessage</a>)</td></tr>
<tr class="memdesc:ac81a7cae2ffada5831320e99047682c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign an error message to this range. <br /></td></tr>
<tr class="separator:ac81a7cae2ffada5831320e99047682c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e657785552ea70303e0f83d18b20c44"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_object_handler_1_1_range_reference.html#a0e657785552ea70303e0f83d18b20c44">errorMessage</a> () const</td></tr>
<tr class="memdesc:a0e657785552ea70303e0f83d18b20c44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the error message associated with this range.  <a href="class_object_handler_1_1_range_reference.html#a0e657785552ea70303e0f83d18b20c44">More...</a><br /></td></tr>
<tr class="separator:a0e657785552ea70303e0f83d18b20c44"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A utility class for parsing range references in string format. </p>
<p>The constructor to this class accepts strings returned from Excel functions such as xlfGetName and xlfReftext. Strings are parsed and their tokens stored in separate variables to facilitate comparisons such as determing whether one range contains another.</p>
<p>Excel returns a variety of strings to represent references. The following formats are supported:</p>
<p>Normal: </p><div class="fragment"><div class="line"><span class="stringliteral">&quot;[Book1.xls]Sheet1!R1C1&quot;</span></div>
</div><!-- fragment --><p>Some excel functions prepend an '=' sign: </p><div class="fragment"><div class="line"><span class="stringliteral">&quot;=[Book1.xls]Sheet1!R1C1&quot;</span></div>
</div><!-- fragment --><p>If book or sheet name contains spaces then Excel encloses the text in single quotes: </p><div class="fragment"><div class="line"><span class="stringliteral">&quot;&#39;[Bo ok1.xls]Sheet1&#39;!R1C1&quot;</span></div>
</div><!-- fragment --><p>If book name contains dots then Excel encloses the text in single quotes: </p><div class="fragment"><div class="line"><span class="stringliteral">&quot;&#39;[Bo.ok1.xls]Sheet1&#39;!R1C1&quot;</span></div>
</div><!-- fragment --><p>For a new book that hasn't yet been saved, excel omits the .xls suffix: </p><div class="fragment"><div class="line"><span class="stringliteral">&quot;[Book1]Sheet1!R1C1&quot;</span></div>
</div><!-- fragment --><p>Sometimes the string includes the filesystem path: </p><div class="fragment"><div class="line"><span class="stringliteral">&quot;=&#39;C:\\path\\to\\[Book1.xls]Sheet1&#39;!R1C1&quot;</span></div>
</div><!-- fragment --><p>If the book contains a single sheet with the same name as the book, then the sheet name is omitted altogether and the book name is not enclosed in []s: </p><div class="fragment"><div class="line"><span class="stringliteral">&quot;same_name.xls!R1C1&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;&#39;same name.xls&#39;!R1C1&quot;</span></div>
</div><!-- fragment --><p>In all cases, the cell reference, represented above as R1C1, may also be given as R1C1:R9C9 i.e. a range consisting of multiple cells, in which case the <a class="el" href="class_object_handler_1_1_range_reference.html" title="A utility class for parsing range references in string format.">RangeReference</a> constructor sets multicell_ to true. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a84eebd82c4d354390601a1c9a3f65256"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84eebd82c4d354390601a1c9a3f65256">&#9670;&nbsp;</a></span>RangeReference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ObjectHandler::RangeReference::RangeReference </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor - initialize the <a class="el" href="class_object_handler_1_1_range_reference.html" title="A utility class for parsing range references in string format.">RangeReference</a> object. </p>
<p>Parse the input string and store its component tokens in separate variables e.g. bookName_, sheetName_, etc.</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>This constructor fails for the following value of address:<br  />
 <code>"'[GBP_MARKET_AND_TRADES.XLSX]1M (2)'!R4C1"</code><br  />
 The bug probably affects all worksheets whose name contains parentheses. The effect of the bug is that if a function on that worksheet fails, the function returns <code>#NUM</code> as usual, but no error message is associated with the calling cell, and <code>ohRangeRetrieveError()</code> does not work for that worksheet. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ad1948b5e060642803a214fc658bf3ff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1948b5e060642803a214fc658bf3ff3">&#9670;&nbsp;</a></span>contains()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ObjectHandler::RangeReference::contains </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_object_handler_1_1_range_reference.html">RangeReference</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine whether this range contains the given one. </p>
<p>This functionality is presently used for processing error messages - An error message may be associated with a multi-cell range and the user can query any subset of that range and still get the relevant error message. </p>

</div>
</div>
<a id="a0e657785552ea70303e0f83d18b20c44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e657785552ea70303e0f83d18b20c44">&#9670;&nbsp;</a></span>errorMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string ObjectHandler::RangeReference::errorMessage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the error message associated with this range. </p>
<p>This function is wrapped by end user function ohRangeRetrieveError(). </p>

</div>
</div>
<a id="a04a535869da4506c72e89ed43fdade6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04a535869da4506c72e89ed43fdade6a">&#9670;&nbsp;</a></span>operator==()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ObjectHandler::RangeReference::operator== </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_object_handler_1_1_range_reference.html">RangeReference</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test two <a class="el" href="class_object_handler_1_1_range_reference.html" title="A utility class for parsing range references in string format.">RangeReference</a> objects for equality. </p>
<p>The two objects may in fact represent the same range even if they were initialized with different strings and this operator handles that case. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="rangereference_8hpp_source.html">rangereference.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
            </div>
            <div class='clearfix'></div>
<div id="footer">SourceForge logo copyright &#169; Open Source Technology Group<br>reposit logo <a href="http://www.reposit.be">copyright &#169; 2015 reposit Ltd Dublin</a><br>all other content <a href="license.html">copyright &#169; 2004-20015 The QuantLib Group</a></div>
        </div>
        <div class='clearfix'></div>
    </div>
    <div class='clearfix'></div>
</body>
</html>
