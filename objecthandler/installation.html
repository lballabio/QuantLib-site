<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>ObjectHandler: Installation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="tabs.css">
    <link rel="stylesheet" href="ql.css">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id='wrapper'>
        <div id='header'>
        <div id='floatleft'><a class="imglink" href="index.html"><img src="images/logo_oh.jpg" width="180" height="72" border="0" alt="ObjectHandler Logo"/></a></div>
        <div id='floatright'><a class="imglink" href="http://quantlib.org"><img src="images/logo_ql.jpg" width="130" height="82" border="0" alt="QuantLib Logo"/></a></div>
        </div>
        <div id='content'>
            <div id='col-left'>
            <div id="version">Version 1.21.0</div>
                <div id='sidebar'>
<ul>
<li class="menuheader"><a href="index.html">Home</a></li>
<li><a href="installation.html">Installation</a></li>
<li><a href="design.html">Design</a></li>
<li><a href="history.html">History</a></li>
<li><a href="license.html">License</a></li>
<li><a href="people.html">People</a></li>
<li class="menuheader"><a href="functional.html">Functional<br>Documentation</a></li>
<li><a href="manual.html">Manual</a></li>
<li><a href="allfunctions.html">Functions</a></li>
<li><a href="categories.html">Categories</a></li>
<li class="menuheader"><a href="technical.html">Technical<br>Documentation</a></li>
<li><a href="annotated.html">Classes</a></li>
<li><a href="hierarchy.html">Hierarchy</a></li>
<li><a href="files.html">Files</a></li>
<li><a href="examples.html">Examples</a></li>
</ul>
                </div>
<div class="logo">
<div class="vspace"></div>
<a href="http://www.reposit.be" id="reposit_logo"></a>
<div class="vspace"></div>
</div>
            </div>
            <div id='col-right'>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Installation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="inst_overview"></a>
Overview</h1>
<p>This document describes how to install and use ObjectHandler on Windows and on systems which use Autoconf e.g. Linux.</p>
<p>ObjectHandler logging is performed by <a href="http://logging.apache.org/log4cxx/index.html">log4cxx</a>, the logging framework for the Apache project. ObjectHandler uses a customized copy of log4cxx version 0.10.0, called "log4cxx 0.10.0f13", amended to provide a boost compliant build process and other minor enhancements.</p>
<p>Some ObjectHandler source code is generated by the <a href="http://www.gensrc.org">gensrc</a> utility.</p>
<p>ObjectHandler, gensrc, and log4cxx 0.10.0f13 are available for download from the <a href="https://bintray.com/quantlib/releases/QuantLibXL/1.21#files">QuantLib downloads page</a> on bintray.</p>
<p>No binary installer is provided for the standalone ObjectHandler library. However ObjectHandler functionality is compiled into the binary installation of <a href="http://www.quantlibxl.org">QuantLibXL</a>.</p>
<dl>
<dt><a class="el" href="installation.html#inst_prerequisites">1 Prerequisites</a> </dt>
<dd><dl>
<dt><a class="el" href="installation.html#inst_pre_conventions">1.1 Conventions</a> </dt>
<dd></dd>
<dt><a class="el" href="installation.html#inst_pre_boost">1.2 Boost</a> </dt>
<dd></dd>
<dt><a class="el" href="installation.html#inst_pre_python">1.3 Python 3.x</a> </dt>
<dd></dd>
</dl>
</dd>
<dt><a class="el" href="installation.html#inst_win">2 Windows</a> </dt>
<dd><dl>
<dt><a class="el" href="installation.html#inst_win_download">2.1 Download</a> </dt>
<dd></dd>
<dt><a class="el" href="installation.html#inst_win_build">2.2 Build</a> </dt>
<dd></dd>
<dt><a class="el" href="installation.html#inst_win_test">2.3 Test</a> </dt>
<dd></dd>
<dt><a class="el" href="installation.html#inst_win_usage">2.4 Usage</a> </dt>
<dd></dd>
</dl>
</dd>
<dt><a class="el" href="installation.html#inst_auto">3 Autoconf</a> </dt>
<dd><dl>
<dt><a class="el" href="installation.html#inst_auto_download">3.1 Download</a> </dt>
<dd></dd>
<dt><a class="el" href="installation.html#inst_auto_build">3.2 Build</a> </dt>
<dd></dd>
<dt><a class="el" href="installation.html#inst_auto_test">3.3 Test</a> </dt>
<dd></dd>
<dt><a class="el" href="installation.html#inst_auto_usage">3.4 Usage</a> </dt>
<dd></dd>
</dl>
</dd>
</dl>
<h1><a class="anchor" id="inst_prerequisites"></a>
1 Prerequisites</h1>
<p>Before proceeding to compile the source code, consult the documents below.</p>
<h2><a class="anchor" id="inst_pre_conventions"></a>
1.1 Conventions</h2>
<p>See the following document regarding naming conventions in use for the project: <a class="el" href="conventions.html">Conventions</a></p>
<h2><a class="anchor" id="inst_pre_boost"></a>
1.2 Boost</h2>
<p>ObjectHandler depends on Boost. Any recent version of Boost should be OK. If you're using VC9 then Boost 1.35 or later is required. QuantLib requires Boost 1.39 or later. You will need the compiled Boost libraries, the Boost header files alone are not sufficient.</p>
<h2><a class="anchor" id="inst_pre_python"></a>
1.3 Python 3.x</h2>
<p>Some ObjectHandler code is autogenerated by gensrc, which is a Python script. Before rebuilding ObjectHandler you need to have Python 3.x installed on your machine. Here is the link to the Python website: <a href="http://www.python.org/">http://www.python.org/</a>.</p>
<p>On Windows, if Python is installed on your machine so that .py files are associated with the Python executable, then the gensrc scripts should build OK with no modification required.</p>
<p>Otherwise, after you install gensrc (below), you might need to edit this file...</p>
<pre class="fragment">    ObjectHandler\gensrc\Makefile.vc
</pre><p>...and set the PYTHON variable equal to the location of the Python executable on your machine, e.g:</p>
<pre class="fragment">    PYTHON=C:\Users\username\AppData\Local\Programs\Python\Python39\python.exe
</pre><h1><a class="anchor" id="inst_win"></a>
2 Windows</h1>
<h2><a class="anchor" id="inst_win_download"></a>
2.1 Download</h2>
<h3><a class="anchor" id="inst_win_directories"></a>
2.1.1 Directories</h3>
<p>The Visual C++ project files for ObjectHandler rely on relative pathnames to refer to prerequisite projects gensrc and log4cxx. In order for this to work, these projects must reside side by side in the directory tree.</p>
<p>Create a new empty folder on your hard drive to serve as the root directory for the build. You can use any path, for purposes of this tutorial the build directory is <code>C:\build_ql_1_21_0</code>. As described below you should copy all of the required source code zip files to that directory and then unzip them in place. After all of the source code is unzipped you should have the following directory structure: </p><pre class="fragment">C:\build_ql_1_21_0\gensrc
C:\build_ql_1_21_0\log4cxx
C:\build_ql_1_21_0\ObjectHandler
</pre><h3><a class="anchor" id="inst_auto_uncompress"></a>
2.1.2 Uncompress the Source Code</h3>
<p>Go to the <a href="https://bintray.com/quantlib/releases/QuantLibXL/1.21#files">QuantLib downloads page</a>.</p>
<p>Download <code>log4cxx-0.10.0f13.zip</code> and uncompress the package to <code>C:\build_ql_1_21_0\log4cxx</code>.</p>
<p>Download <code>gensrc-1.21.0.zip</code> and uncompress the package to <code>C:\build_ql_1_21_0\gensrc</code>.</p>
<p>Download <code>ObjectHandler-1.21.0.zip</code> and uncompress the package to <code>C:\build_ql_1_21_0\ObjectHandler</code>.</p>
<h2><a class="anchor" id="inst_win_build"></a>
2.2 Build</h2>
<p>ObjectHandler is available in three configurations:</p>
<table border="1" cellspacing="3" cellpadding="3">
<tr>
<td><b>Project</b></td><td><b>Description</b> </td></tr>
<tr>
<td>ohlib</td><td>static library to be linked into standalone C++ applications </td></tr>
<tr>
<td>ohxllib</td><td>static library with additional functionality for Excel, to be statically linked into a single client XLL </td></tr>
<tr>
<td>ohxll</td><td>a standalone XLL comprising a global object repository which can be shared by other XLLs in the Excel session</td></tr>
</table>
<p>NB: The ohxll build of ObjectHandler requires a DLL version of the VC runtime library i.e. <code>Debug</code> or <code>Release</code>.</p>
<p>To build all available configurations and related examples - Open solution <code>ObjectHandler\ObjectHandler_vc?.sln</code>, choose configuration <code>Release</code>, and execute menu item <code>Build | Build Solution</code>.</p>
<h2><a class="anchor" id="inst_win_test"></a>
2.3 Test</h2>
<h3><a class="anchor" id="inst_win_test_cpp"></a>
2.3.1 C++</h3>
<p>Open a DOS prompt in directory </p><pre class="fragment">C:\build_ql_1_21_0\ObjectHandler\Examples\C++\bin
</pre><p>Execute the example program. The output should appear similar to the following: </p><pre class="fragment">C:\build_ql_1_21_0\ObjectHandler\Examples\C++\bin&gt;ExampleCpp-vc80-mt-1_21_0.exe
INFO - begin example program
INFO - High level interrogation - after constructor
INFO - log dump of object with ID = account2

property = ObjectId             value = account2
property = ClassName            value = Account
property = Permanent            value = 0
property = Customer             value = customer1
property = Number               value = 987654321
property = Type                 value = Current
property = Balance              value = 100
Permanent = false


INFO - Low-level interrogation - after update
INFO - Result of getBalance on underlying = 100
INFO - Log all objects after deleting account2:
INFO - dump of all objects in ObjectHandler:

Object with ID = account1:

property = ObjectId             value = account1
property = ClassName            value = Account
property = Permanent            value = 0
property = Customer             value = customer1
property = Number               value = 123456789
property = Type                 value = Savings
property = Balance              value = Null
Permanent = false

Object with ID = customer1:

property = ObjectId             value = customer1
property = ClassName            value = Customer
property = Permanent            value = false
property = Name                 value = Joe
property = Age                  value = 40
Permanent = false


INFO - Balance of account account2 = 200
INFO - The initially time of creating account2 is
INFO - 05/14/2008 10:47:58
INFO - The last time of creating account2 is
INFO - 05/14/2008 10:47:58
INFO - relation the objects list is
INFO - customer1
INFO - End example program
</pre><h3><a class="anchor" id="inst_win_test_static"></a>
2.3.2 XLL - Static Link</h3>
<ul>
<li>Start Excel </li>
<li>Load the following files: <pre class="fragment">ObjectHandler\Examples\xl\xll\ExampleXLLStatic-vc??-mt-1_21_0.xll
ObjectHandler\Examples\xl\exampleStatic.xls
</pre> </li>
<li>Hit <code>Ctrl-Alt-F9</code> to recalculate</li>
</ul>
<h3><a class="anchor" id="inst_win_test_dynamic"></a>
2.3.3 XLL - Dynamic Link</h3>
<ul>
<li>Start Excel </li>
<li>Load the following files: <pre class="fragment">ObjectHandler\xll\ObjectHandler-xll-vc??-mt-1_21_0.xll
ObjectHandler\Examples\xl\xll\ExampleXLLDynamic1-vc??-mt-1_21_0.xll
ObjectHandler\Examples\xl\xll\ExampleXLLDynamic2-vc??-mt-1_21_0.xll
ObjectHandler\Examples\xl\exampleDynamic.xls
</pre> </li>
<li>Hit <code>Ctrl-Alt-F9</code> to recalculate</li>
</ul>
<h2><a class="anchor" id="inst_win_usage"></a>
2.4 Usage</h2>
<p>In order to link ObjectHandler into your own project, use the configuration that corresponds to your chosen build as summarized in the tables below. Please refer to the example application indicated.</p>
<h3><a class="anchor" id="inst_win_ohlib"></a>
2.4.1 ohlib</h3>
<table class="doxtable">
<tr>
<td><b>Project</b> </td><td>ohlib  </td></tr>
<tr>
<td><b>Description</b> </td><td>Core ObjectHandler C++ static library  </td></tr>
<tr>
<td><b>Example Client Application</b> </td><td>ExampleCpp  </td></tr>
<tr>
<td><b>Preprocessor Defines</b> </td><td>-  </td></tr>
<tr>
<td><b>Include Directories</b> </td><td>$(OBJECT_HANDLER_DIR)  </td></tr>
<tr>
<td><b>Link Directories</b> </td><td>$(OBJECT_HANDLER_DIR)\lib<br  />
$(LOG4CXX_DIR)\msvc\Lib  </td></tr>
<tr>
<td><b>Link Libraries</b> </td><td>ws2_32.lib  </td></tr>
</table>
<h3><a class="anchor" id="inst_win_ohxllib"></a>
2.4.2 ohxllib</h3>
<table class="doxtable">
<tr>
<td><b>Project</b> </td><td>ohxllib  </td></tr>
<tr>
<td><b>Description</b> </td><td>Excel static library  </td></tr>
<tr>
<td><b>Example Client Application</b> </td><td>ExampleXllStatic  </td></tr>
<tr>
<td><b>Preprocessor Defines</b> </td><td>XLL_STATIC  </td></tr>
<tr>
<td><b>Include Directories</b> </td><td>$(OBJECT_HANDLER_DIR)  </td></tr>
<tr>
<td><b>Link Directories</b> </td><td>$(OBJECT_HANDLER_DIR)\xlsdk\lib<br  />
$(OBJECT_HANDLER_DIR)\ohxl\ohxllib\lib<br  />
$(LOG4CXX_DIR)\msvc\Lib  </td></tr>
<tr>
<td><b>Link Libraries</b> </td><td>ws2_32.lib  </td></tr>
</table>
<h3><a class="anchor" id="inst_win_ohxll"></a>
2.4.3 ohxll</h3>
<table class="doxtable">
<tr>
<td><b>Project</b> </td><td>ohxll  </td></tr>
<tr>
<td><b>Description</b> </td><td>Excel dynamic library  </td></tr>
<tr>
<td><b>Example Client Application</b> </td><td>ExampleXllDynamic  </td></tr>
<tr>
<td><b>Preprocessor Defines</b> </td><td>XLL_IMPORTS  </td></tr>
<tr>
<td><b>Include Directories</b> </td><td>$(OBJECT_HANDLER_DIR)  </td></tr>
<tr>
<td><b>Link Directories</b> </td><td>$(OBJECT_HANDLER_DIR)\xlsdk\lib<br  />
$(OBJECT_HANDLER_DIR)\ohxl\ohxl\xll  </td></tr>
<tr>
<td><b>Link Libraries</b> </td><td>-  </td></tr>
</table>
<h3><a class="anchor" id="inst_win_include"></a>
2.4.4 #include</h3>
<p>In all cases you need to add the following directive to your project's source file: </p><pre class="fragment">#include &lt;oh/objecthandler.hpp&gt;
</pre><h3><a class="anchor" id="inst_win_link"></a>
2.4.5 Link</h3>
<p>Your project's link to the ObjectHandler library is established automatically by the directive </p><pre class="fragment">#pragma comment(lib, OBJHANDLER_LIB_NAME)
</pre><p> in file <code>oh/autolink.hpp</code></p>
<p>The name of the library depends on your compiler and configuration. For example, if you're using VC8, configuration Release (static runtime), the library is called </p><pre class="fragment">ObjectHandler-vc80-mt-s-1_21_0.lib
</pre><p>The location of the library depends on which project you're using (ohlib/ohxllib/ohxll), please consult the tables above.</p>
<h1><a class="anchor" id="inst_auto"></a>
3 Autoconf</h1>
<h2><a class="anchor" id="inst_auto_download"></a>
3.1 Download</h2>
<h3><a class="anchor" id="inst_auto_directories"></a>
3.1.1 Directories</h3>
<p>This example assumes that you do not have root access to your machine, so that the entire build and installation environment resides under your home directory.</p>
<p>Let's say your home directory is <code>/home/erik</code>. Create two subdirectories under that, one where you will compile the code and the other where you will install it: </p><pre class="fragment">/home/erik/build
/home/erik/install
</pre><h3><a class="anchor" id="inst_auto_uncompress"></a>
2.1.2 Uncompress the Source Code</h3>
<p>Go to the <a href="https://bintray.com/quantlib/releases/QuantLibXL/1.21#files">QuantLib downloads page</a>.</p>
<p>Download <code>log4cxx-0.10.0f13.tar.gz</code> and uncompress the package to <code>/home/erik/build/log4cxx-0.10.0</code>.</p>
<p>Download <code>gensrc-1.21.0.tgz</code> and uncompress the package to <code>/home/erik/build/gensrc-1.21.0</code>.</p>
<p>Download <code>ObjectHandler-1.21.0.tgz</code> and uncompress the package to <code>/home/erik/build/ObjectHandler-1.21.0</code>.</p>
<h2><a class="anchor" id="inst_auto_build"></a>
3.2 Build</h2>
<h3><a class="anchor" id="inst_auto_log4cxx"></a>
3.2.1 Build log4cxx</h3>
<p>Support for log4cxx is optional. If you do not require logging, then when you configure <a class="el" href="namespace_object_handler.html" title="ObjectHandler.">ObjectHandler</a> (see below), pass in the argument <code>&ndash;without-log4cxx</code>, which will cause log messages to be written to stdout instead of to the log file. In that case you can skip ahead to the next section, <a class="el" href="installation.html#inst_auto_oh">3.2.2 Build ObjectHandler</a>. If you need logging, read on.</p>
<p>First you need to install apr and apr-utils. Our copy of log4cxx includes source code for apr and apr-utils. In the past we used to build them with these commands:</p>
<pre class="fragment">cd /home/erik/build/log4cxx-0.10.0/src/apr
./buildconf
./configure --prefix=/home/erik/install
make install
cd /home/erik/build/log4cxx-0.10.0/src/apr-util
./buildconf
./configure --prefix=/home/erik/install --with-apr=/home/erik/install
make install
</pre><p>But those commands no longer seem to work on new linux systems. There might be a binary release available for your platform, on ubuntu you might try something like this:</p>
<pre class="fragment">sudo apt-get install libapr1-dev libaprutil1-dev
</pre><p>Another possibility is to go to the apache web site and download the latest sources for apr and apr-utils. At the time of this writing the files are apr-1.5.1.tar.gz and apr-util-1.5.3.tar.gz. Copy them to a temp directory, untar them, and compile them something like this:</p>
<pre class="fragment">cd /home/erik/temp/apr-1.5.1
./buildconf
./configure --prefix=/home/erik/install
make install
cd /home/erik/temp/apr-util-1.5.3
./buildconf --with-apr=../apr-1.5.1
./configure --prefix=/home/erik/install --with-apr=../apr-1.5.1
make install
</pre><p>Once you have apr and apr-utils installed, go back and build log4cxx:</p>
<pre class="fragment">cd /home/erik/build/log4cxx-0.10.0
./autogen.sh
./configure --prefix=/home/erik/install --with-apr=/home/erik/install \
    --with-apr-util=/home/erik/install
make install
</pre><h3><a class="anchor" id="inst_auto_oh"></a>
3.2.2 Build ObjectHandler</h3>
<p>If you don't need logging, pass in the argument <code>&ndash;without-log4cxx</code> to <code>configure</code>.</p>
<pre class="fragment">cd /home/erik/build/ObjectHandler-1.21.0
./configure --with-gensrc=/home/erik/build/gensrc-1.21.0 \
    --prefix=/home/erik/install \
    CPPFLAGS=-I/home/erik/install/include \
    LDFLAGS=-L/home/erik/install/lib
make install
</pre><h2><a class="anchor" id="inst_auto_test"></a>
3.3 Test</h2>
<pre class="fragment">cd /home/erik/build/ObjectHandler-1.21.0/Examples/C++
./ExampleCpp
</pre><p>This should generate output similar to the following:</p>
<pre class="fragment">[erik@client2 C++]$ ./ExampleCpp 
INFO - begin example program
INFO - High level interrogation - after constructor
INFO - log dump of object with ID = account2

property = Balance              value = 100                 
property = ClassName            value = Account             
property = Customer             value = customer1           
property = Number               value = 987654321           
property = ObjectId             value = account2            
property = Permanent            value = 0                   
property = Type                 value = Current             
Permanent = false               


INFO - Low-level interrogation - after update
INFO - Result of getBalance on underlying = 100
INFO - Log all objects after deleting account2:
INFO - dump of all objects in ObjectHandler:

Object with ID = account1:

property = Balance              value = [Null value]        
property = ClassName            value = Account             
property = Customer             value = customer1           
property = Number               value = 123456789           
property = ObjectId             value = account1            
property = Permanent            value = 0                   
property = Type                 value = Savings             
Permanent = false               

Object with ID = customer1:

property = Age                  value = 40                  
property = ClassName            value = Customer            
property = Name                 value = Joe                 
property = ObjectId             value = customer1           
property = Permanent            value = false               
Permanent = false               


INFO - Balance of account account2 = 200
INFO - The initially time of creating account2 is 
INFO - 08/28/2008 15:54:18
INFO - The last time of creating account2 is 
INFO - 08/28/2008 15:54:18
INFO - relation the objects list is 
INFO - customer1
INFO - End example program
</pre><h2><a class="anchor" id="inst_auto_usage"></a>
3.4 Usage</h2>
<p>To incorporate ObjectHandler functionality into your own applications:</p>
<p>The header you need is </p><pre class="fragment">#include &lt;oh/objecthandler.hpp&gt;
</pre><p>To compile your program, ensure that the path containing the ObjectHandler header is among those searched by your compiler. If you have followed the build instructions above, the command would be</p>
<pre class="fragment">g++ -I/home/erik/install/include -c -o yourapp.o yourapp.cpp
</pre><p>When linking your program use the -l option to tell gcc to link to the log4cxx and ObjectHandler libraries, and use -L to specify the path containing those libraries, e.g:</p>
<pre class="fragment">g++ -o yourapp yourapp.o -L/home/erik/install/lib \
    -lObjectHandler -llog4cxx
</pre><p>Finally before invoking your executable you need to ensure that your loader knows where to find the log4cxx and ObjectHandler libraries, e.g:</p>
<pre class="fragment">export LD_LIBRARY_PATH=/home/erik/install/lib
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
            </div>
            <div class='clearfix'></div>
<div id="footer">SourceForge logo copyright &#169; Open Source Technology Group<br>reposit logo <a href="http://www.reposit.be">copyright &#169; 2015 reposit Ltd Dublin</a><br>all other content <a href="license.html">copyright &#169; 2004-20015 The QuantLib Group</a></div>
        </div>
        <div class='clearfix'></div>
    </div>
    <div class='clearfix'></div>
</body>
</html>
