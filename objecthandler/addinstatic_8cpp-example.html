<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>ObjectHandler: addinstatic.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="tabs.css">
    <link rel="stylesheet" href="ql.css">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id='wrapper'>
        <div id='header'>
        <div id='floatleft'><a class="imglink" href="index.html"><img src="images/logo_oh.jpg" width="180" height="72" border="0" alt="ObjectHandler Logo"/></a></div>
        <div id='floatright'><a class="imglink" href="http://quantlib.org"><img src="images/logo_ql.jpg" width="130" height="82" border="0" alt="QuantLib Logo"/></a></div>
        </div>
        <div id='content'>
            <div id='col-left'>
            <div id="version">Version 1.21.0</div>
                <div id='sidebar'>
<ul>
<li class="menuheader"><a href="index.html">Home</a></li>
<li><a href="installation.html">Installation</a></li>
<li><a href="design.html">Design</a></li>
<li><a href="history.html">History</a></li>
<li><a href="license.html">License</a></li>
<li><a href="people.html">People</a></li>
<li class="menuheader"><a href="functional.html">Functional<br>Documentation</a></li>
<li><a href="manual.html">Manual</a></li>
<li><a href="allfunctions.html">Functions</a></li>
<li><a href="categories.html">Categories</a></li>
<li class="menuheader"><a href="technical.html">Technical<br>Documentation</a></li>
<li><a href="annotated.html">Classes</a></li>
<li><a href="hierarchy.html">Hierarchy</a></li>
<li><a href="files.html">Files</a></li>
<li><a href="examples.html">Examples</a></li>
</ul>
                </div>
<div class="logo">
<div class="vspace"></div>
<a href="http://www.reposit.be" id="reposit_logo"></a>
<div class="vspace"></div>
</div>
            </div>
            <div id='col-right'>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">addinstatic.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>XLL which links statically to ObjectHandler</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> This file is part of QuantLib, a free-software/open-source library</span></div>
<div class="line"><span class="comment"> for financial quantitative analysts and developers - http://quantlib.org/</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> QuantLib is free software: you can redistribute it and/or modify it</span></div>
<div class="line"><span class="comment"> under the terms of the QuantLib license.  You should have received a</span></div>
<div class="line"><span class="comment"> copy of the license along with this program; if not, please email</span></div>
<div class="line"><span class="comment"> &lt;quantlib-dev@lists.sf.net&gt;. The license is also available online at</span></div>
<div class="line"><span class="comment"> &lt;http://quantlib.org/license.shtml&gt;.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> This program is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><span class="comment"> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span></div>
<div class="line"><span class="comment"> FOR A PARTICULAR PURPOSE.  See the license for more details.</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="typefactory_8hpp.html">oh/enumerations/typefactory.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="objecthandlerxl_8hpp.html">ohxl/objecthandlerxl.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="register__all_8hpp.html">ohxl/register/register_all.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ohxl/functions/export.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="xlutilities_8hpp.html">ohxl/utilities/xlutilities.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ExampleObjects/accountexample.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="objectwrapperxl_8hpp.html">ohxl/objectwrapperxl.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Use BOOST_MSVC instead of _MSC_VER since some other vendors (Metrowerks,</span></div>
<div class="line"><span class="comment">   for example) also #define _MSC_VER</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"><span class="preprocessor">#ifdef BOOST_MSVC</span></div>
<div class="line"><span class="preprocessor">#  define BOOST_LIB_DIAGNOSTIC</span></div>
<div class="line"><span class="preprocessor">#  include &lt;oh/auto_link.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#  undef BOOST_LIB_DIAGNOSTIC</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"> </div>
<div class="line">DLLEXPORT <span class="keywordtype">int</span> xlAutoOpen() {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Instantiate the ObjectHandler Repository</span></div>
<div class="line">    <span class="keyword">static</span> <a name="_a0"></a><a class="code" href="class_object_handler_1_1_repository_x_l.html">ObjectHandler::RepositoryXL</a> repositoryXL;</div>
<div class="line">    <span class="comment">// Instantiate the Enumerated Type Registry</span></div>
<div class="line">    <span class="keyword">static</span> <a name="_a1"></a><a class="code" href="class_object_handler_1_1_enum_type_registry.html">ObjectHandler::EnumTypeRegistry</a> enumTypeRegistry;</div>
<div class="line">    <span class="comment">// Instantiate the Enumerated Class Registry</span></div>
<div class="line">    <span class="keyword">static</span> <a name="_a2"></a><a class="code" href="class_object_handler_1_1_enum_class_registry.html">ObjectHandler::EnumClassRegistry</a> enumClassRegistry;</div>
<div class="line">    <span class="comment">// Instantiate the Enumerated Pair Registry</span></div>
<div class="line">    <span class="keyword">static</span> <a name="_a3"></a><a class="code" href="class_object_handler_1_1_enum_pair_registry.html">ObjectHandler::EnumPairRegistry</a> enumPairRegistry;</div>
<div class="line">    <span class="comment">//Instantiate the Processor Factory</span></div>
<div class="line">    <span class="keyword">static</span> <a name="_a4"></a><a class="code" href="class_object_handler_1_1_processor_factory.html">ObjectHandler::ProcessorFactory</a> processorFactory;</div>
<div class="line">    <span class="comment">// Instantiate the Serialization Factory</span></div>
<div class="line">    <span class="keyword">static</span> AccountExample::SerializationFactory factory;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> XLOPER xDll;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">        Excel(xlGetName, &amp;xDll, 0);</div>
<div class="line"> </div>
<div class="line">        <a name="a5"></a><a class="code" href="class_object_handler_1_1_singleton.html#ab9a592c3a92f574b0b30c62a674448a0">ObjectHandler::Configuration::instance</a>().<a name="a6"></a><a class="code" href="class_object_handler_1_1_configuration.html#af018f535c937f9c4e68b61fe80005749">init</a>();</div>
<div class="line"> </div>
<div class="line">        registerOhFunctions(xDll);</div>
<div class="line">        AccountExample::registerEnumeratedTypes();</div>
<div class="line"> </div>
<div class="line">        Excel(xlfRegister, 0, 7, &amp;xDll,</div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x0A&quot;</span><span class="stringliteral">&quot;ohCustomer&quot;</span>),          <span class="comment">// function code name</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x06&quot;</span><span class="stringliteral">&quot;CCCNL#&quot;</span>),              <span class="comment">// parameter codes</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x0A&quot;</span><span class="stringliteral">&quot;ohCustomer&quot;</span>),          <span class="comment">// function display name</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x1B&quot;</span><span class="stringliteral">&quot;ObjectID,Name,Age,Permanent&quot;</span>), <span class="comment">// comma-delimited list of parameters</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x01&quot;</span><span class="stringliteral">&quot;1&quot;</span>),                   <span class="comment">// function type (0 = hidden function, 1 = worksheet function, 2 = command macro)</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x07&quot;</span><span class="stringliteral">&quot;Example&quot;</span>));            <span class="comment">// function category</span></div>
<div class="line"> </div>
<div class="line">        Excel(xlfRegister, 0, 7, &amp;xDll,</div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x09&quot;</span><span class="stringliteral">&quot;ohAccount&quot;</span>),           <span class="comment">// function code name</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x08&quot;</span><span class="stringliteral">&quot;CCCCNPL#&quot;</span>),            <span class="comment">// parameter codes</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x09&quot;</span><span class="stringliteral">&quot;ohAccount&quot;</span>),           <span class="comment">// function display name</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x2F&quot;</span><span class="stringliteral">&quot;ObjectID,Customer,Type,Number,Balance,Permanent&quot;</span>), <span class="comment">// comma-delimited list of parameters</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x01&quot;</span><span class="stringliteral">&quot;1&quot;</span>),                   <span class="comment">// function type (0 = hidden function, 1 = worksheet function, 2 = command macro)</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x07&quot;</span><span class="stringliteral">&quot;Example&quot;</span>));            <span class="comment">// function category</span></div>
<div class="line"> </div>
<div class="line">        Excel(xlfRegister, 0, 7, &amp;xDll,</div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x13&quot;</span><span class="stringliteral">&quot;ohAccountSetBalance&quot;</span>), <span class="comment">// function code name</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x04&quot;</span><span class="stringliteral">&quot;LCE#&quot;</span>),                <span class="comment">// parameter codes</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x13&quot;</span><span class="stringliteral">&quot;ohAccountSetBalance&quot;</span>), <span class="comment">// function display name</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x10&quot;</span><span class="stringliteral">&quot;ObjectID,Balance&quot;</span>),    <span class="comment">// comma-delimited list of parameters</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x01&quot;</span><span class="stringliteral">&quot;1&quot;</span>),                   <span class="comment">// function type (0 = hidden function, 1 = worksheet function, 2 = command macro)</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x07&quot;</span><span class="stringliteral">&quot;Example&quot;</span>));            <span class="comment">// function category</span></div>
<div class="line"> </div>
<div class="line">        Excel(xlfRegister, 0, 7, &amp;xDll,</div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x10&quot;</span><span class="stringliteral">&quot;ohAccountBalance&quot;</span>),    <span class="comment">// function code name</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x04&quot;</span><span class="stringliteral">&quot;ECP#&quot;</span>),                <span class="comment">// parameter codes</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x10&quot;</span><span class="stringliteral">&quot;ohAccountBalance&quot;</span>),    <span class="comment">// function display name</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x10&quot;</span><span class="stringliteral">&quot;ObjectID,Trigger&quot;</span>),    <span class="comment">// comma-delimited list of parameters</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x01&quot;</span><span class="stringliteral">&quot;1&quot;</span>),                   <span class="comment">// function type (0 = hidden function, 1 = worksheet function, 2 = command macro)</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x07&quot;</span><span class="stringliteral">&quot;Example&quot;</span>));            <span class="comment">// function category</span></div>
<div class="line"> </div>
<div class="line">        Excel(xlfRegister, 0, 7, &amp;xDll,</div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x0D&quot;</span><span class="stringliteral">&quot;ohAccountType&quot;</span>),       <span class="comment">// function code name</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x04&quot;</span><span class="stringliteral">&quot;CCP#&quot;</span>),                <span class="comment">// parameter codes</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x0D&quot;</span><span class="stringliteral">&quot;ohAccountType&quot;</span>),       <span class="comment">// function code name</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x10&quot;</span><span class="stringliteral">&quot;ObjectID,Trigger&quot;</span>),    <span class="comment">// comma-delimited list of parameters</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x01&quot;</span><span class="stringliteral">&quot;1&quot;</span>),                   <span class="comment">// function type (0 = hidden function, 1 = worksheet function, 2 = command macro)</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x07&quot;</span><span class="stringliteral">&quot;Example&quot;</span>));            <span class="comment">// function category</span></div>
<div class="line"> </div>
<div class="line">        Excel(xlfRegister, 0, 7, &amp;xDll,</div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x15&quot;</span><span class="stringliteral">&quot;ohAccountCustomerName&quot;</span>),<span class="comment">// function code name</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x04&quot;</span><span class="stringliteral">&quot;CCP#&quot;</span>),                <span class="comment">// parameter codes</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x15&quot;</span><span class="stringliteral">&quot;ohAccountCustomerName&quot;</span>),<span class="comment">// function display name</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x10&quot;</span><span class="stringliteral">&quot;ObjectID,Trigger&quot;</span>),    <span class="comment">// comma-delimited list of parameters</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x01&quot;</span><span class="stringliteral">&quot;1&quot;</span>),                   <span class="comment">// function type (0 = hidden function, 1 = worksheet function, 2 = command macro)</span></div>
<div class="line">            TempStrNoSize(<span class="stringliteral">&quot;\x07&quot;</span><span class="stringliteral">&quot;Example&quot;</span>));            <span class="comment">// function category</span></div>
<div class="line"> </div>
<div class="line">        Excel(xlFree, 0, 1, &amp;xDll);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line"> </div>
<div class="line">        std::ostringstream err;</div>
<div class="line">        err &lt;&lt; <span class="stringliteral">&quot;Error loading ExampleXllStatic: &quot;</span> &lt;&lt; e.what();</div>
<div class="line">        Excel(xlcAlert, 0, 1, TempStrStl(err.str()));</div>
<div class="line">        Excel(xlFree, 0, 1, &amp;xDll);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"> </div>
<div class="line">        Excel(xlFree, 0, 1, &amp;xDll);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">DLLEXPORT <span class="keywordtype">int</span> xlAutoClose() {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> XLOPER xDll;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">        Excel(xlGetName, &amp;xDll, 0);</div>
<div class="line"> </div>
<div class="line">        AccountExample::unregisterEnumeratedTypes();</div>
<div class="line">        unregisterOhFunctions(xDll);</div>
<div class="line">        <a name="a7"></a><a class="code" href="class_object_handler_1_1_repository_x_l.html#af79278189d5203d91b553d10a25e90d6">ObjectHandler::RepositoryXL::instance</a>().<a name="a8"></a><a class="code" href="class_object_handler_1_1_repository_x_l.html#a893e1e420a8c4c827f6897f64a9352e0">clear</a>();</div>
<div class="line"> </div>
<div class="line">        Excel(xlFree, 0, 1, &amp;xDll);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line"> </div>
<div class="line">        std::ostringstream err;</div>
<div class="line">        err &lt;&lt; <span class="stringliteral">&quot;Error unloading ExampleXllStatic: &quot;</span> &lt;&lt; e.what();</div>
<div class="line">        Excel(xlcAlert, 0, 1, TempStrStl(err.str()));</div>
<div class="line">        Excel(xlFree, 0, 1, &amp;xDll);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"> </div>
<div class="line">        Excel(xlFree, 0, 1, &amp;xDll);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">DLLEXPORT <span class="keywordtype">void</span> xlAutoFree(XLOPER *px) {</div>
<div class="line"> </div>
<div class="line">    <a name="a9"></a><a class="code" href="xlutilities_8hpp.html#abded3ba5610e6be5616ee0f3a9d58818">freeOper</a>(px);</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">DLLEXPORT <span class="keywordtype">char</span> *ohCustomer(</div>
<div class="line">        <span class="keywordtype">char</span> *objectID,</div>
<div class="line">        <span class="keywordtype">char</span> *name,</div>
<div class="line">        <span class="keywordtype">long</span> *age,</div>
<div class="line">        <span class="keywordtype">bool</span> *permanent) {</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;ObjectHandler::FunctionCall&gt; functionCall;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">        functionCall = boost::shared_ptr&lt;ObjectHandler::FunctionCall&gt;</div>
<div class="line">            (<span class="keyword">new</span> <a name="_a10"></a><a class="code" href="class_object_handler_1_1_function_call.html">ObjectHandler::FunctionCall</a>(<span class="stringliteral">&quot;ohCustomer&quot;</span>));</div>
<div class="line"> </div>
<div class="line">        boost::shared_ptr&lt;ObjectHandler::ValueObject&gt; valueObject(</div>
<div class="line">            <span class="keyword">new</span> AccountExample::CustomerValueObject(objectID, name, *age, *permanent));</div>
<div class="line"> </div>
<div class="line">        boost::shared_ptr&lt;ObjectHandler::Object&gt; object(</div>
<div class="line">            <span class="keyword">new</span> AccountExample::CustomerObject(valueObject, name, *age, *permanent));</div>
<div class="line"> </div>
<div class="line">        std::string returnValue = </div>
<div class="line">            <a class="code" href="class_object_handler_1_1_repository_x_l.html#af79278189d5203d91b553d10a25e90d6">ObjectHandler::RepositoryXL::instance</a>().<a name="a11"></a><a class="code" href="class_object_handler_1_1_repository_x_l.html#a661de81c3bb0fcd198b70485eb282e46">storeObject</a>(objectID, <span class="keywordtype">object</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">static</span> <span class="keywordtype">char</span> ret[XL_MAX_STR_LEN];</div>
<div class="line">        <a name="a12"></a><a class="code" href="namespace_object_handler.html#a749fc7e3e73be55b2ef518c734ee0d8a">ObjectHandler::stringToChar</a>(returnValue, ret);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="class_object_handler_1_1_repository_x_l.html#af79278189d5203d91b553d10a25e90d6">ObjectHandler::RepositoryXL::instance</a>().<a name="a13"></a><a class="code" href="class_object_handler_1_1_repository_x_l.html#a47f6346114416272fc1f2c62fa799a6d">logError</a>(e.what(), functionCall);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">DLLEXPORT <span class="keywordtype">char</span> *ohAccount(</div>
<div class="line">        <span class="keywordtype">char</span> *objectID,</div>
<div class="line">        <span class="keywordtype">char</span> *customer,</div>
<div class="line">        <span class="keywordtype">char</span> *type,</div>
<div class="line">        <span class="keywordtype">long</span> *number,</div>
<div class="line">        OPER *balance,</div>
<div class="line">        <span class="keywordtype">bool</span> *permanent) {</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;ObjectHandler::FunctionCall&gt; functionCall;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">        functionCall = boost::shared_ptr&lt;ObjectHandler::FunctionCall&gt;</div>
<div class="line">            (<span class="keyword">new</span> <a class="code" href="class_object_handler_1_1_function_call.html">ObjectHandler::FunctionCall</a>(<span class="stringliteral">&quot;ohAccount&quot;</span>));</div>
<div class="line"> </div>
<div class="line">        <a name="a14"></a><a class="code" href="ohdefines_8hpp.html#ae04eab8e5cf42210eddb99403599ae6f">OH_GET_REFERENCE</a>(customerRef, customer,</div>
<div class="line">            AccountExample::CustomerObject, AccountExample::Customer)</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">double</span> balanceDouble = ObjectHandler::convert2&lt;double&gt;(</div>
<div class="line">            <a name="_a15"></a><a class="code" href="class_object_handler_1_1_convert_oper.html">ObjectHandler::ConvertOper</a>(*balance), <span class="stringliteral">&quot;balance&quot;</span>, 100.00);</div>
<div class="line"> </div>
<div class="line">        <a name="_a16"></a><a class="code" href="class_object_handler_1_1property__t.html">ObjectHandler::property_t</a> balanceProperty =</div>
<div class="line">            ObjectHandler::convert2&lt;ObjectHandler::property_t&gt;(</div>
<div class="line">                <a class="code" href="class_object_handler_1_1_convert_oper.html">ObjectHandler::ConvertOper</a>(*balance), <span class="stringliteral">&quot;balance&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        AccountExample::Account::Type typeEnum =</div>
<div class="line">            <a name="_a17"></a><a class="code" href="class_object_handler_1_1_create.html">ObjectHandler::Create&lt;AccountExample::Account::Type&gt;</a>()(type);</div>
<div class="line"> </div>
<div class="line">        boost::shared_ptr&lt;ObjectHandler::ValueObject&gt; valueObject(</div>
<div class="line">            <span class="keyword">new</span> AccountExample::AccountValueObject(objectID, customer, type, *number, balanceProperty, *permanent));</div>
<div class="line"> </div>
<div class="line">        boost::shared_ptr&lt;ObjectHandler::Object&gt; object(</div>
<div class="line">            <span class="keyword">new</span> AccountExample::AccountObject(valueObject, customerRef, typeEnum, *number, balanceDouble, *permanent));</div>
<div class="line"> </div>
<div class="line">    </div>
<div class="line">        std::string returnValue = </div>
<div class="line">            <a class="code" href="class_object_handler_1_1_repository_x_l.html#af79278189d5203d91b553d10a25e90d6">ObjectHandler::RepositoryXL::instance</a>().<a class="code" href="class_object_handler_1_1_repository_x_l.html#a661de81c3bb0fcd198b70485eb282e46">storeObject</a>(objectID, <span class="keywordtype">object</span>, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">static</span> <span class="keywordtype">char</span> ret[XL_MAX_STR_LEN];</div>
<div class="line">        <a class="code" href="namespace_object_handler.html#a749fc7e3e73be55b2ef518c734ee0d8a">ObjectHandler::stringToChar</a>(returnValue, ret);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="class_object_handler_1_1_repository_x_l.html#af79278189d5203d91b553d10a25e90d6">ObjectHandler::RepositoryXL::instance</a>().<a class="code" href="class_object_handler_1_1_repository_x_l.html#a47f6346114416272fc1f2c62fa799a6d">logError</a>(e.what(), functionCall);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">DLLEXPORT <span class="keywordtype">short</span> <span class="keywordtype">int</span> *ohAccountSetBalance(<span class="keywordtype">char</span> *objectID, <span class="keywordtype">double</span> *balance) {</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;ObjectHandler::FunctionCall&gt; functionCall;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">        functionCall = boost::shared_ptr&lt;ObjectHandler::FunctionCall&gt;</div>
<div class="line">            (<span class="keyword">new</span> <a class="code" href="class_object_handler_1_1_function_call.html">ObjectHandler::FunctionCall</a>(<span class="stringliteral">&quot;ohAccountSetBalance&quot;</span>));</div>
<div class="line"> </div>
<div class="line">        <a name="a18"></a><a class="code" href="ohdefines_8hpp.html#a523ba6d4f8fdf75d75612da8016c8f0d">OH_GET_OBJECT</a>(accountObject, objectID, AccountExample::AccountObject)</div>
<div class="line">        accountObject-&gt;setBalance(*balance);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">static</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> ret = TRUE;</div>
<div class="line">        <span class="keywordflow">return</span> &amp;ret;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="class_object_handler_1_1_repository_x_l.html#af79278189d5203d91b553d10a25e90d6">ObjectHandler::RepositoryXL::instance</a>().<a class="code" href="class_object_handler_1_1_repository_x_l.html#a47f6346114416272fc1f2c62fa799a6d">logError</a>(e.what(), functionCall);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">DLLEXPORT <span class="keywordtype">double</span> *ohAccountBalance(<span class="keywordtype">char</span> *objectID, OPER *trigger) {</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;ObjectHandler::FunctionCall&gt; functionCall;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">        functionCall = boost::shared_ptr&lt;ObjectHandler::FunctionCall&gt;</div>
<div class="line">            (<span class="keyword">new</span> <a class="code" href="class_object_handler_1_1_function_call.html">ObjectHandler::FunctionCall</a>(<span class="stringliteral">&quot;ohAccountBalance&quot;</span>));</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="ohdefines_8hpp.html#a523ba6d4f8fdf75d75612da8016c8f0d">OH_GET_OBJECT</a>(accountObject, objectID, AccountExample::AccountObject)</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">static</span> <span class="keywordtype">double</span> ret;</div>
<div class="line">        ret = accountObject-&gt;balance();</div>
<div class="line">        <span class="keywordflow">return</span> &amp;ret;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="class_object_handler_1_1_repository_x_l.html#af79278189d5203d91b553d10a25e90d6">ObjectHandler::RepositoryXL::instance</a>().<a class="code" href="class_object_handler_1_1_repository_x_l.html#a47f6346114416272fc1f2c62fa799a6d">logError</a>(e.what(), functionCall);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">DLLEXPORT <span class="keywordtype">char</span> *ohAccountCustomerName(<span class="keywordtype">char</span> *objectID, OPER *trigger) {</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;ObjectHandler::FunctionCall&gt; functionCall;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">        functionCall = boost::shared_ptr&lt;ObjectHandler::FunctionCall&gt;</div>
<div class="line">            (<span class="keyword">new</span> <a class="code" href="class_object_handler_1_1_function_call.html">ObjectHandler::FunctionCall</a>(<span class="stringliteral">&quot;ohAccountCustomerName&quot;</span>));</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="ohdefines_8hpp.html#ae04eab8e5cf42210eddb99403599ae6f">OH_GET_REFERENCE</a>(accountRef, objectID,</div>
<div class="line">            AccountExample::AccountObject, AccountExample::Account)</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">static</span> <span class="keywordtype">char</span> ret[XL_MAX_STR_LEN];</div>
<div class="line">        <a class="code" href="namespace_object_handler.html#a749fc7e3e73be55b2ef518c734ee0d8a">ObjectHandler::stringToChar</a>(accountRef-&gt;customerName(), ret);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="class_object_handler_1_1_repository_x_l.html#af79278189d5203d91b553d10a25e90d6">ObjectHandler::RepositoryXL::instance</a>().<a class="code" href="class_object_handler_1_1_repository_x_l.html#a47f6346114416272fc1f2c62fa799a6d">logError</a>(e.what(), functionCall);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">DLLEXPORT <span class="keywordtype">char</span> *ohAccountType(<span class="keywordtype">char</span> *objectID, OPER *trigger) {</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;ObjectHandler::FunctionCall&gt; functionCall;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">        functionCall = boost::shared_ptr&lt;ObjectHandler::FunctionCall&gt;</div>
<div class="line">            (<span class="keyword">new</span> <a class="code" href="class_object_handler_1_1_function_call.html">ObjectHandler::FunctionCall</a>(<span class="stringliteral">&quot;ohAccountType&quot;</span>));</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="ohdefines_8hpp.html#a523ba6d4f8fdf75d75612da8016c8f0d">OH_GET_OBJECT</a>(accountObject, objectID, AccountExample::AccountObject)</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">static</span> <span class="keywordtype">char</span> ret[XL_MAX_STR_LEN];</div>
<div class="line">        <a class="code" href="namespace_object_handler.html#a749fc7e3e73be55b2ef518c734ee0d8a">ObjectHandler::stringToChar</a>(accountObject-&gt;type(), ret);</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="class_object_handler_1_1_repository_x_l.html#af79278189d5203d91b553d10a25e90d6">ObjectHandler::RepositoryXL::instance</a>().<a class="code" href="class_object_handler_1_1_repository_x_l.html#a47f6346114416272fc1f2c62fa799a6d">logError</a>(e.what(), functionCall);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="atypefactory_8hpp_html"><div class="ttname"><a href="typefactory_8hpp.html">typefactory.hpp</a></div><div class="ttdoc">Class RegistryManager - Manage access to an Enumeration Registry.</div></div>
<div class="ttc" id="aregister__all_8hpp_html"><div class="ttname"><a href="register__all_8hpp.html">register_all.hpp</a></div><div class="ttdoc">Register/Unregister the Addin functions with Excel.</div></div>
<div class="ttc" id="aclass_object_handler_1_1_repository_x_l_html_a661de81c3bb0fcd198b70485eb282e46"><div class="ttname"><a href="class_object_handler_1_1_repository_x_l.html#a661de81c3bb0fcd198b70485eb282e46">ObjectHandler::RepositoryXL::storeObject</a></div><div class="ttdeci">virtual std::string storeObject(const std::string &amp;objectID, const boost::shared_ptr&lt; Object &gt; &amp;obj, bool overwrite=false, boost::shared_ptr&lt; ValueObject &gt; valueObject=boost::shared_ptr&lt; ValueObject &gt;())</div><div class="ttdoc">Wrapper for the storeObject function in the base class.</div></div>
<div class="ttc" id="aobjecthandlerxl_8hpp_html"><div class="ttname"><a href="objecthandlerxl_8hpp.html">objecthandlerxl.hpp</a></div><div class="ttdoc">#includes for all functionality in ObjectHandler</div></div>
<div class="ttc" id="aohdefines_8hpp_html_ae04eab8e5cf42210eddb99403599ae6f"><div class="ttname"><a href="ohdefines_8hpp.html#ae04eab8e5cf42210eddb99403599ae6f">OH_GET_REFERENCE</a></div><div class="ttdeci">#define OH_GET_REFERENCE(NAME, ID, OBJECT_CLASS, LIBRARY_CLASS)</div><div class="ttdoc">Get a shared pointer to the library object referenced by an Object.</div><div class="ttdef"><b>Definition:</b> ohdefines.hpp:99</div></div>
<div class="ttc" id="aclass_object_handler_1_1_repository_x_l_html"><div class="ttname"><a href="class_object_handler_1_1_repository_x_l.html">ObjectHandler::RepositoryXL</a></div><div class="ttdoc">Excel-specific enhancements to the Repository class.</div><div class="ttdef"><b>Definition:</b> repositoryxl.hpp:40</div></div>
<div class="ttc" id="aclass_object_handler_1_1_convert_oper_html"><div class="ttname"><a href="class_object_handler_1_1_convert_oper.html">ObjectHandler::ConvertOper</a></div><div class="ttdoc">Perform datatype conversions of OPERs.</div><div class="ttdef"><b>Definition:</b> convert_oper.hpp:50</div></div>
<div class="ttc" id="aclass_object_handler_1_1_function_call_html"><div class="ttname"><a href="class_object_handler_1_1_function_call.html">ObjectHandler::FunctionCall</a></div><div class="ttdoc">Singleton encapsulating state relating to Excel function call.</div><div class="ttdef"><b>Definition:</b> functioncall.hpp:56</div></div>
<div class="ttc" id="axlutilities_8hpp_html_abded3ba5610e6be5616ee0f3a9d58818"><div class="ttname"><a href="xlutilities_8hpp.html#abded3ba5610e6be5616ee0f3a9d58818">freeOper</a></div><div class="ttdeci">DLL_API void freeOper(XLOPER *px)</div><div class="ttdoc">Free any memory associated with the XLOPER.</div></div>
<div class="ttc" id="aclass_object_handler_1_1property__t_html"><div class="ttname"><a href="class_object_handler_1_1property__t.html">ObjectHandler::property_t</a></div><div class="ttdoc">A value of variant type.</div><div class="ttdef"><b>Definition:</b> property.hpp:57</div></div>
<div class="ttc" id="axlutilities_8hpp_html"><div class="ttname"><a href="xlutilities_8hpp.html">xlutilities.hpp</a></div><div class="ttdoc">General utility functions for the Excel platform.</div></div>
<div class="ttc" id="aohdefines_8hpp_html_a523ba6d4f8fdf75d75612da8016c8f0d"><div class="ttname"><a href="ohdefines_8hpp.html#a523ba6d4f8fdf75d75612da8016c8f0d">OH_GET_OBJECT</a></div><div class="ttdeci">#define OH_GET_OBJECT(NAME, ID, OBJECT_CLASS)</div><div class="ttdoc">Get a boost shared pointer to a class derived from Object.</div><div class="ttdef"><b>Definition:</b> ohdefines.hpp:87</div></div>
<div class="ttc" id="aclass_object_handler_1_1_create_html"><div class="ttname"><a href="class_object_handler_1_1_create.html">ObjectHandler::Create</a></div><div class="ttdoc">Create the enumerated type associated with a string.</div><div class="ttdef"><b>Definition:</b> typefactory.hpp:135</div></div>
<div class="ttc" id="anamespace_object_handler_html_a749fc7e3e73be55b2ef518c734ee0d8a"><div class="ttname"><a href="namespace_object_handler.html#a749fc7e3e73be55b2ef518c734ee0d8a">ObjectHandler::stringToChar</a></div><div class="ttdeci">DLL_API void stringToChar(const std::string &amp;, char *)</div><div class="ttdoc">Convert the std::string to the char*.</div></div>
<div class="ttc" id="aclass_object_handler_1_1_repository_x_l_html_af79278189d5203d91b553d10a25e90d6"><div class="ttname"><a href="class_object_handler_1_1_repository_x_l.html#af79278189d5203d91b553d10a25e90d6">ObjectHandler::RepositoryXL::instance</a></div><div class="ttdeci">static RepositoryXL &amp; instance()</div><div class="ttdoc">Client applications access the global object via a call to RepositoryXL::instance().</div></div>
<div class="ttc" id="aclass_object_handler_1_1_configuration_html_af018f535c937f9c4e68b61fe80005749"><div class="ttname"><a href="class_object_handler_1_1_configuration.html#af018f535c937f9c4e68b61fe80005749">ObjectHandler::Configuration::init</a></div><div class="ttdeci">void init()</div><div class="ttdoc">Initialize the global Configuration Singleton object.</div></div>
<div class="ttc" id="aclass_object_handler_1_1_singleton_html_ab9a592c3a92f574b0b30c62a674448a0"><div class="ttname"><a href="class_object_handler_1_1_singleton.html#ab9a592c3a92f574b0b30c62a674448a0">ObjectHandler::Singleton&lt; Configuration &gt;::instance</a></div><div class="ttdeci">static Configuration &amp; instance()</div><div class="ttdoc">access to the unique instance</div><div class="ttdef"><b>Definition:</b> singleton.hpp:72</div></div>
<div class="ttc" id="aclass_object_handler_1_1_repository_x_l_html_a47f6346114416272fc1f2c62fa799a6d"><div class="ttname"><a href="class_object_handler_1_1_repository_x_l.html#a47f6346114416272fc1f2c62fa799a6d">ObjectHandler::RepositoryXL::logError</a></div><div class="ttdeci">void logError(const std::string &amp;message, const boost::shared_ptr&lt; FunctionCall &gt; &amp;functionCall)</div><div class="ttdoc">Log an error message.</div></div>
<div class="ttc" id="aclass_object_handler_1_1_repository_x_l_html_a893e1e420a8c4c827f6897f64a9352e0"><div class="ttname"><a href="class_object_handler_1_1_repository_x_l.html#a893e1e420a8c4c827f6897f64a9352e0">ObjectHandler::RepositoryXL::clear</a></div><div class="ttdeci">virtual void clear()</div><div class="ttdoc">Clear the state of the Singleton.</div></div>
<div class="ttc" id="aclass_object_handler_1_1_processor_factory_html"><div class="ttname"><a href="class_object_handler_1_1_processor_factory.html">ObjectHandler::ProcessorFactory</a></div><div class="ttdoc">Manage all of the Processor objects which are defined for this environment.</div><div class="ttdef"><b>Definition:</b> processor.hpp:107</div></div>
<div class="ttc" id="aclass_object_handler_1_1_enum_class_registry_html"><div class="ttname"><a href="class_object_handler_1_1_enum_class_registry.html">ObjectHandler::EnumClassRegistry</a></div><div class="ttdoc">A concrete instantiation of the Registry class, for enumerated classes.</div><div class="ttdef"><b>Definition:</b> enumregistry.hpp:58</div></div>
<div class="ttc" id="aclass_object_handler_1_1_enum_pair_registry_html"><div class="ttname"><a href="class_object_handler_1_1_enum_pair_registry.html">ObjectHandler::EnumPairRegistry</a></div><div class="ttdoc">A concrete instantiation of the Registry class, for &quot;pairs&quot;.</div><div class="ttdef"><b>Definition:</b> enumregistry.hpp:87</div></div>
<div class="ttc" id="aobjectwrapperxl_8hpp_html"><div class="ttname"><a href="objectwrapperxl_8hpp.html">objectwrapperxl.hpp</a></div><div class="ttdoc">Class ObjectWrapperXL - Customization of the ObjectWrapper class for the Excel platform.</div></div>
<div class="ttc" id="aclass_object_handler_1_1_enum_type_registry_html"><div class="ttname"><a href="class_object_handler_1_1_enum_type_registry.html">ObjectHandler::EnumTypeRegistry</a></div><div class="ttdoc">A concrete instantiation of the Registry class, for enumerated types.</div><div class="ttdef"><b>Definition:</b> enumregistry.hpp:35</div></div>
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
            </div>
            <div class='clearfix'></div>
<div id="footer">SourceForge logo copyright &#169; Open Source Technology Group<br>reposit logo <a href="http://www.reposit.be">copyright &#169; 2015 reposit Ltd Dublin</a><br>all other content <a href="license.html">copyright &#169; 2004-20015 The QuantLib Group</a></div>
        </div>
        <div class='clearfix'></div>
    </div>
    <div class='clearfix'></div>
</body>
</html>
