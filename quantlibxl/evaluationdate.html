<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>QuantLibXL: Evaluation Date</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="tabs.css">
    <link rel="stylesheet" href="ql.css">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id='wrapper'>
        <div id='header'>
        <div id='floatleft'><a class="imglink" href="index.html"><img src="images/logo_qlxl.jpg" width="180" height="72" border="0" alt="QuantLibXL Logo"/></a></div>
        <div id='floatright'><a class="imglink" href="http://quantlib.org"><img src="images/logo_ql.jpg" width="130" height="82" border="0" alt="QuantLib Logo"/></a></div>
        </div>
        <div id='content'>
            <div id='col-left'>
            <div id="version">Version 1.22.0</div>
                <div id='sidebar'>
<ul>
<li class="menuheader"><a href="index.html">Home</a></li>
<li><a href="installation.html">Download</a></li>
<li><a href="compile.html">Compile</a></li>
<li><a href="history.html">History</a></li>
<li><a href="license.html">License</a></li>
<li><a href="people.html">People</a></li>
<li><a href="faq.html">FAQ</a></li>
<li class="menuheader"><a href="functional.html">Functional<br>Documentation</a></li>
<li><a href="manual.html">Manual</a></li>
<li><a href="allfunctions.html">Functions</a></li>
<li><a href="categories.html">Categories</a></li>
<li><a href="enums.html">Enumerations</a></li>
<li><a href="framework.html">Framework</a></li>
</ul>
                </div>
<div class="logo">
<div class="vspace"></div>
<a href="http://www.reposit.be" id="reposit_logo"></a>
<div class="vspace"></div>
</div>
            </div>
            <div id='col-right'>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Evaluation Date </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="center"><small><a href="manual.html">back to reference manual index</a></small></div><h1><a class="anchor" id="eval_summary"></a>
Summary</h1>
<p>This document summarizes processing for the Evaluation Date. By default QuantLib stores the evaluation date as a global variable shared by all objects in the current QuantLib instance. Under this implementation, all objects in a given QuantLibAddin session - for example, all open workbooks in a given Excel session - share a single global instance of the evaluation date.</p>
<p>Alternatively QuantLib offers support for Sessions which allow the client application to implement multiple instances of the evaluation date. When this functionality is enabled, QuantLibAddin defines a session as an Excel workbook, so that a group of related objects which require a common instance of the evaluation date can be isolated in a single workbook.</p>
<p>Within any given context, the value of the evaluation date can be set with QuantLibAddin function <a href="auto/settings.html#qlSettingsSetEvaluationDate">qlSettingsSetEvaluationDate</a> and queried with function <a href="auto/settings.html#qlSettingsEvaluationDate">qlSettingsEvaluationDate</a>.</p>
<h1><a class="anchor" id="eval_quantlib"></a>
QuantLib</h1>
<p>In QuantLib, the evaluation date is implemented in a global object (called Settings). QuantLib supports various methods which enable the client application to set the value of the evaluation date. Any object which depends on the evaluation date consults this global value when required. If the evaluation date is not set explicitly then it defaults to the current date as computed by the system clock (and the value is incremented when the clock passes midnight).</p>
<h1><a class="anchor" id="eval_session"></a>
Session</h1>
<p>The behavior described above may lead to undesired results, for example if two different objects require different evaluation dates within a single running instance of QuantLib. To cater for this situation, QuantLib supports the concept of a Session. A session constitutes a separate instance of the global state, i.e. a separate instance of the evaluation date variable.</p>
<p>QuantLib doesn't specify what constitutes the physical implementation of a session and client applications are left to define this as required for the local environment. For example a session could be implemented as a thread, or as a web service. Multiple sessions share a single instance of QuantLib.</p>
<h1><a class="anchor" id="eval_quantlibaddin"></a>
QuantLibAddin</h1>
<p>The QuantLibAddin default build doesn't implement QuantLib's session functionality.</p>
<p>At present the only means for specifying the evaluation date that is exposed by the QuantLibAddin interface is function qlSettingsSetEvaluationDate. Before any call to qlSettingsSetEvaluationDate, the evaluation date defaults to the current date on the system clock; any call to qlSettingsSetEvaluationDate explicitly specifies the evaluation date.</p>
<p>Consider a single Excel session in which multiple cells invoke qlSettingsSetEvaluationDate, specifying different values for the evaluation date. Each call overwrites the global value. The sequence in which the calls are executed is dictated by Excel's dependency calculation tree. Other cells in the Excel session which depend on the evaluation date will see a different value depending on when they are refreshed.</p>
<h1><a class="anchor" id="eval_workbook"></a>
Workbook as Session</h1>
<p>QuantLibAddin can be configured to support QuantLib sessions. QuantLibAddin implements a session as a workbook. Whenever the value of the evaluation date is set - either through an explicit call to qlSettingsSetEvaluationDate, or by being left to default to the current system date - that value prevails for all sheets and cells in the given workbook. This has the following implications:</p>
<ul>
<li>If multiple distinct values are required for evaluation date, this can be effected by using multiple workbooks. Each workbook contains 1) a single cell which sets the evaluation date and 2) any objects which may depend on that value </li>
<li>Within a single workbook there is still the potential problem that multiple calls to qlSettingsSetEvaluationDate overwrite the workbook-wide value of evaluation date. Multiple objects requiring different instances of the evaluation date must not reside in a single workbook.</li>
</ul>
<h1><a class="anchor" id="eval_implementation"></a>
Implementation</h1>
<p>To enable support for sessions in QuantLib/QuantLibAddin, edit file</p>
<pre class="fragment">QuantLib\ql\userconfig.hpp
</pre><p>and uncomment line</p>
<pre class="fragment">#define QL_ENABLE_SESSIONS
</pre><p>then recompile QuantLib and QuantLibAddin.</p>
<h1><a class="anchor" id="eval_multithreading"></a>
Multithreading</h1>
<p>Much of the discussion about QuantLib sessions has centered on the topic of multithreading, which is not relevant to QuantLibAddin. QuantLibAddin executes in a single process thread which is shared by all open workbooks in a given Excel session.</p>
<h1><a class="anchor" id="eval_crossplatform"></a>
Cross-Platform Support</h1>
<p>At present QuantLibAddin implements QuantLib sessions only on the Microsoft Excel platform.</p>
<h1><a class="anchor" id="eval_links"></a>
Links</h1>
<p>Follow the links below for relevant threads in the QuantLib mailing lists.</p>
<p><a href="http://sourceforge.net/mailarchive/forum.php?thread_id=8151830&amp;forum_id=4299">2005-09-09</a><br  />
 <a href="http://sourceforge.net/mailarchive/forum.php?thread_id=7875915&amp;forum_id=4299">2005-08-02</a><br  />
 <a href="http://sourceforge.net/mailarchive/forum.php?thread_id=7144644&amp;forum_id=4299">2005-04-28</a><br  />
 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
            </div>
            <div class='clearfix'></div>
<div id="footer">SourceForge logo copyright &#169; Open Source Technology Group<br>reposit logo <a href="http://www.reposit.be">copyright &#169; 2015 reposit Ltd Dublin</a><br>all other content <a href="license.html">copyright &#169; 2004-20015 The QuantLib Group</a></div>
        </div>
        <div class='clearfix'></div>
    </div>
    <div class='clearfix'></div>
</body>
</html>
