<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>QuantLibXL: Observer/Observable Design Pattern</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="tabs.css">
    <link rel="stylesheet" href="ql.css">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id='wrapper'>
        <div id='header'>
        <div id='floatleft'><a class="imglink" href="index.html"><img src="images/logo_qlxl.jpg" width="180" height="72" border="0" alt="QuantLibXL Logo"/></a></div>
        <div id='floatright'><a class="imglink" href="http://quantlib.org"><img src="images/logo_ql.jpg" width="130" height="82" border="0" alt="QuantLib Logo"/></a></div>
        </div>
        <div id='content'>
            <div id='col-left'>
            <div id="version">Version 1.22.0</div>
                <div id='sidebar'>
<ul>
<li class="menuheader"><a href="index.html">Home</a></li>
<li><a href="installation.html">Download</a></li>
<li><a href="compile.html">Compile</a></li>
<li><a href="history.html">History</a></li>
<li><a href="license.html">License</a></li>
<li><a href="people.html">People</a></li>
<li><a href="faq.html">FAQ</a></li>
<li class="menuheader"><a href="functional.html">Functional<br>Documentation</a></li>
<li><a href="manual.html">Manual</a></li>
<li><a href="allfunctions.html">Functions</a></li>
<li><a href="categories.html">Categories</a></li>
<li><a href="enums.html">Enumerations</a></li>
<li><a href="framework.html">Framework</a></li>
</ul>
                </div>
<div class="logo">
<div class="vspace"></div>
<a href="http://www.reposit.be" id="reposit_logo"></a>
<div class="vspace"></div>
</div>
            </div>
            <div id='col-right'>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Observer/Observable Design Pattern </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="center"><small><a href="manual.html">back to reference manual index</a></small></div><h1><a class="anchor" id="observer_overview"></a>
Overview</h1>
<p>QuantLib implements a mechanism called the Observer/Observable Design Pattern in which Observer objects hold references to Observable objects, and the Observables automatically notify Observers of changes. QuantLibXL workbooks may be designed to exploit this feature so that updates are made behind the scenes, independent of Excel's recalculation mechanism, resulting in improved performance. The technique is dependent upon ObjectHandler's concepts of <a class="el" href="references.html">References, Permanent Objects and Triggers</a>.</p>
<h1><a class="anchor" id="observer_implementation"></a>
Implementation</h1>
<p>A YieldTermStructure observes its associated RateHelper objects, such that changes to rates are automatically communicated to the term structure. The update is "lazy": when referenced, the YTS asks its RHs if they have changed, if so the YTS re-bootstraps itself.</p>
<p>QuantLibXL workbooks can use the following technique: </p><ul>
<li>create a sheet to instantiate the RH objects, then close it </li>
<li>create a sheet to receive the live data feed, updating the existing RHs non-destructively by calling their setQuote() methods. Keep this sheet open. </li>
<li>create a sheet to instantiate the YTS, then close it</li>
</ul>
<p>With the above environment, the sheets which instantiated the RHs and YTS are closed, meaning that Excel cannot invoke recalculation of those cells. Only the data feed is active, updating the state of the RHs non-destructively. Because of QL's Observer/Observable pattern, changes in the state of the RHs are reflected in that of the YTS, invisible to Excel and without triggering the recalculation of any cells. Now an instrument may be priced based on the YTS.</p>
<p>The YTS refers to the RHs with raw strings rather than Excel cell references. The same is true of the link from the Instrument to the YTS. The YTS and RH objects are created as permanent objects. Triggers are used to force a dependency between the Instrument and the live data feed. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
            </div>
            <div class='clearfix'></div>
<div id="footer">SourceForge logo copyright &#169; Open Source Technology Group<br>reposit logo <a href="http://www.reposit.be">copyright &#169; 2015 reposit Ltd Dublin</a><br>all other content <a href="license.html">copyright &#169; 2004-20015 The QuantLib Group</a></div>
        </div>
        <div class='clearfix'></div>
    </div>
    <div class='clearfix'></div>
</body>
</html>
