<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>QuantLibXL: Framework</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="tabs.css">
    <link rel="stylesheet" href="ql.css">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id='wrapper'>
        <div id='header'>
        <div id='floatleft'><a class="imglink" href="index.html"><img src="images/logo_qlxl.jpg" width="180" height="72" border="0" alt="QuantLibXL Logo"/></a></div>
        <div id='floatright'><a class="imglink" href="http://quantlib.org"><img src="images/logo_ql.jpg" width="130" height="82" border="0" alt="QuantLib Logo"/></a></div>
        </div>
        <div id='content'>
            <div id='col-left'>
            <div id="version">Version 1.21.0</div>
                <div id='sidebar'>
<ul>
<li class="menuheader"><a href="index.html">Home</a></li>
<li><a href="installation.html">Download</a></li>
<li><a href="compile.html">Compile</a></li>
<li><a href="history.html">History</a></li>
<li><a href="license.html">License</a></li>
<li><a href="people.html">People</a></li>
<li><a href="faq.html">FAQ</a></li>
<li class="menuheader"><a href="functional.html">Functional<br>Documentation</a></li>
<li><a href="manual.html">Manual</a></li>
<li><a href="allfunctions.html">Functions</a></li>
<li><a href="categories.html">Categories</a></li>
<li><a href="enums.html">Enumerations</a></li>
<li><a href="framework.html">Framework</a></li>
</ul>
                </div>
<div class="logo">
<div class="vspace"></div>
<a href="http://www.reposit.be" id="reposit_logo"></a>
<div class="vspace"></div>
</div>
            </div>
            <div id='col-right'>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Framework </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table border="1" bgcolor="lightsteelblue">
<tr>
<td><b>NB:</b> The Framework is not maintained, it was last updated in version 1.8 (2016).  </td></tr>
</table>
<p>The QuantLibXL Framework is an application layer written in Excel VBA which wraps the QuantLibXL Addin with additional functionality in support of market data feeds, creation of instruments, etc.</p>
<dl>
<dt><a class="el" href="framework.html#fw_overview">1 Overview</a> </dt>
<dd><dl>
<dt><a class="el" href="framework.html#fw_installation">1.1 Installation</a> </dt>
<dd></dd>
<dt><a class="el" href="framework.html#fw_startup">1.2 Startup</a> </dt>
<dd></dd>
<dt><a class="el" href="framework.html#fw_ui">1.3 User Interface</a> </dt>
<dd></dd>
</dl>
</dd>
<dt><a class="el" href="framework.html#fw_code">2 Code</a> </dt>
<dd><dl>
<dt><a class="el" href="framework.html#fw_code_main">2.1 QuantLibXL.xla</a> </dt>
<dd></dd>
<dt><a class="el" href="framework.html#fw_code_errors">2.2 Errors.xla</a> </dt>
<dd></dd>
<dt><a class="el" href="framework.html#fw_code_utils">2.3 Utilities.xla</a> </dt>
<dd></dd>
<dt><a class="el" href="framework.html#fw_code_config">2.4 Configuration.xla</a> </dt>
<dd></dd>
<dt><a class="el" href="framework.html#fw_code_loader">2.5 Loader.xla</a> </dt>
<dd></dd>
<dt><a class="el" href="framework.html#fw_code_events">2.6 Events.xla</a> </dt>
<dd></dd>
<dt><a class="el" href="framework.html#fw_code_keyboard">2.7 Keyboard.xla</a> </dt>
<dd></dd>
<dt><a class="el" href="framework.html#fw_code_shortcut">2.8 Shortcut.xla</a> </dt>
<dd></dd>
<dt><a class="el" href="framework.html#fw_code_menu">2.9 Menu.xla</a> </dt>
<dd></dd>
<dt><a class="el" href="framework.html#fw_code_cell_menu">2.10 CellMenu.xla</a> </dt>
<dd></dd>
<dt><a class="el" href="framework.html#fw_code_xml">2.11 Serialization.xla</a> </dt>
<dd></dd>
</dl>
</dd>
</dl>
<h1><a class="anchor" id="fw_overview"></a>
1 Overview</h1>
<h2><a class="anchor" id="fw_installation"></a>
1.1 Installation</h2>
<p>The application only works under 32-bit Excel. Under 64-bit Excel, the XLL works, but the VBA code does not.</p>
<p>Here is the link to the zip file for 32-bit Excel:</p>
<p><a href="https://sourceforge.net/projects/quantlib/files/QuantLibXL/1.8.0/QuantLibXL-1.8.0-framework.zip">QuantLibXL-1.8.0-framework.zip</a>.</p>
<p>We have packaged up a build for 64-bit Excel, and it is configured to load the 64-bit XLL, but as mentioned the VBA code does not work under 64-bit Excel so this build is broken. If you would like to help fix it then please send mail to <a href="https://lists.sourceforge.net/lists/listinfo/quantlib-users">quantlib-users@lists.sf.net</a>.</p>
<p><a href="https://sourceforge.net/projects/quantlib/files/QuantLibXL/1.8.0/QuantLibXL-1.8.0-x64-RateCurveFramework.zip">QuantLibXL-1.8.0-x64-RateCurveFramework.zip</a>.</p>
<p>Download the zip file to your hard drive and uncompress it.</p>
<h2><a class="anchor" id="fw_startup"></a>
1.2 Startup</h2>
<p>The installation provides a large selection of DOS batch files for launching the application. For each supported currency, two batch files are provided, one for a live data feed (if you have Reuters installed on your machine) and another which loads a static snapshot of market data. Choose the desired batch file, e.g. <b><code>session_file.EUR-s-static.bat</code></b>, and double-click it.</p>
<p>Excel should start up and load the Framework application, which should then initialize the chosen market data environment. After a few moments you should see the main checks workbook:</p>
<div class="center"><img src="images/framework_fixed_income.png" alt="" class="inline"/></div><p>The market environment is now initialized with over 2,000 data objects loaded (rates, indexes, curves, ...) You can now create pricing worksheets which define instruments that price against this data.</p>
<h2><a class="anchor" id="fw_ui"></a>
1.3 User Interface</h2>
<p>The Framework menu appears on the ribbon under the Add-Ins tab.</p>
<div class="center"><img src="images/framework_menu.png" alt="" class="inline"/></div><p>The menu is context sensitive. The first item in the menu displays the functions supported for the active workbook. If no workbook is active, or if the active workbook does not belong to the Framework, then the menu placeholder [Workbook] appears grayed out as in the image above.</p>
<p>Similarly the second item in the menu is the function configured for the active worksheet, if any, otherwise the word [Worksheet] grayed out.</p>
<p>The third item in the menu displays the functionality relating to whatever Addin is currently loaded.</p>
<p>Right clicking in a cell brings up a QuantLibXL menu.</p>
<div class="center"><img src="images/framework_right_click_menu.png" alt="" class="inline"/></div><p>Similar to the main menu bar, the contents of the right click menu may change depending on which workbook, worksheet, or range is active, or which addins are loaded.</p>
<h1><a class="anchor" id="fw_code"></a>
2 Code</h1>
<p>QuantLibXL.xla resides in the framework directory and all of the other Excel VBA code resides in xla files in the addin subdirectory.</p>
<p>A comment block is provided for every addin (xla) file in the ThisWorkbook module.</p>
<p>Every addin is given a project name in the format qlxlXxx. Naming every project with the qlxl prefix causes the addins to appear together in the project window in the Excel VBA editor.</p>
<h2><a class="anchor" id="fw_code_main"></a>
2.1 QuantLibXL.xla</h2>
<p>QuantLibXL.xla is the entry point for the application. The Workbook_Open event loads some additional modules which are essential for minimum functionality: Errors.xla, Utilities.xla, Configuration.xla, Loader.xla</p>
<h2><a class="anchor" id="fw_code_errors"></a>
2.2 Errors.xla</h2>
<p>Errors.xla provides a central implementation for all error handling for the application. Errors.xla implements three functions in support of error handling:</p>
<p>raiseError: To be called at the point where an error is detected.</p>
<p>propagateError: May be called at an intermediate frame in the stack - above where the error is detected and below where it is handled. Appends additional information to the error.</p>
<p>displayError: Displays the error message to the user. All entry points into the Excel VBA code must be wrapped in On Error Goto / Catch, and the Catch must call displayError.</p>
<h2><a class="anchor" id="fw_code_utils"></a>
2.3 Utilities.xla</h2>
<p>Implements various utility functions for the application, including access to the file system, processing for ranges/sheets/books, etc.</p>
<h2><a class="anchor" id="fw_code_config"></a>
2.4 Configuration.xla</h2>
<p>Configuration.xla implements a global singleton object which encapsulates various information related to the running instance of the Framework application. The configuration object is accessed via wrapper function Config, e.g:</p>
<p>Debug.Print "root dir = " &amp; Config().rootDirectory</p>
<h2><a class="anchor" id="fw_code_loader"></a>
2.5 Loader.xla</h2>
<p>Loader.xla implements a facility for loading components required by a given instance of the Framework. A component can comprise any item which may be loaded or utilitzed from Excel, e.g. worksheets, addins (VBA, C++, etc), DLLs.</p>
<p>The loader allows dependencies between components to be defined. When a request is made to load a given component, the loader checks whether that component's prerequisites are present and loads them if not.</p>
<p>The environments recognized by the loader are configured in workbook QuantLibXL\framework\config\Loader.xls. Loader.xla imports Loader.xls at startup.</p>
<p>To load a given environment, call loadEnvironment("xxx") where xxx is a column in Loader.xls.</p>
<h2><a class="anchor" id="fw_code_events"></a>
2.6 Events.xla</h2>
<p>Events.xla implements an event listener which intercepts various Excel events, such as the activation of a workbook. These event handlers are used to call various Framework functionality, such as recreating menu items in response to a change in context.</p>
<h2><a class="anchor" id="fw_code_keyboard"></a>
2.7 Keyboard.xla</h2>
<p>Keyboard.xla implements a few keyboard shortcuts for the application.</p>
<h2><a class="anchor" id="fw_code_shortcut"></a>
2.8 Shortcut.xla</h2>
<p>Shortcut.xla is a small utility addin which can be used to create a shortcut (icon, link) for the Framework application. For example, after installing the Framework to a network drive, you can use Shortcut.xla to generate a .lnk file that anyone can use to invoke the application from the server.</p>
<h2><a class="anchor" id="fw_code_menu"></a>
2.9 Menu.xla</h2>
<p>Menu.xla creates the QuantLibXL menu on the main Excel toolbar.</p>
<h2><a class="anchor" id="fw_code_cell_menu"></a>
2.10 CellMenu.xla</h2>
<p>CellMenu.xla creates the QuantLibXL entry on the menu which appears when the user right clicks on a cell or range.</p>
<h2><a class="anchor" id="fw_code_xml"></a>
2.11 Serialization.xla</h2>
<p>Serialization.xla implements support for serialization. This implementation relies on the fact that the QuantLibAddin C++ layer implements boost::serialization for all of the classes in the QuantLib library. Serialization.xla can be used to export/import a hierarchy of objects from/to a workbook. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
            </div>
            <div class='clearfix'></div>
<div id="footer">SourceForge logo copyright &#169; Open Source Technology Group<br>reposit logo <a href="http://www.reposit.be">copyright &#169; 2015 reposit Ltd Dublin</a><br>all other content <a href="license.html">copyright &#169; 2004-20015 The QuantLib Group</a></div>
        </div>
        <div class='clearfix'></div>
    </div>
    <div class='clearfix'></div>
</body>
</html>
