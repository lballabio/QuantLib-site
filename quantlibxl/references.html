<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>QuantLibXL: References, Permanent Objects and Triggers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="tabs.css">
    <link rel="stylesheet" href="ql.css">
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id='wrapper'>
        <div id='header'>
        <div id='floatleft'><a class="imglink" href="index.html"><img src="images/logo_qlxl.jpg" width="180" height="72" border="0" alt="QuantLibXL Logo"/></a></div>
        <div id='floatright'><a class="imglink" href="http://quantlib.org"><img src="images/logo_ql.jpg" width="130" height="82" border="0" alt="QuantLib Logo"/></a></div>
        </div>
        <div id='content'>
            <div id='col-left'>
            <div id="version">Version 1.22.0</div>
                <div id='sidebar'>
<ul>
<li class="menuheader"><a href="index.html">Home</a></li>
<li><a href="installation.html">Download</a></li>
<li><a href="compile.html">Compile</a></li>
<li><a href="history.html">History</a></li>
<li><a href="license.html">License</a></li>
<li><a href="people.html">People</a></li>
<li><a href="faq.html">FAQ</a></li>
<li class="menuheader"><a href="functional.html">Functional<br>Documentation</a></li>
<li><a href="manual.html">Manual</a></li>
<li><a href="allfunctions.html">Functions</a></li>
<li><a href="categories.html">Categories</a></li>
<li><a href="enums.html">Enumerations</a></li>
<li><a href="framework.html">Framework</a></li>
</ul>
                </div>
<div class="logo">
<div class="vspace"></div>
<a href="http://www.reposit.be" id="reposit_logo"></a>
<div class="vspace"></div>
</div>
            </div>
            <div id='col-right'>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">References, Permanent Objects and Triggers </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="center"><small><a href="manual.html">back to reference manual index</a></small></div><h1><a class="anchor" id="ref_overview"></a>
Overview</h1>
<ul>
<li>On the Excel platform, one object may refer to another either by a cell reference, or by the raw string representing the object's ID. The use of raw strings allows objects to be referenced even if the workbook which instantiated them is closed. </li>
<li>It may be useful for objects referenced in this way to be declared "permanent" so that they are not deleted by functions <a class="el" href="func_garbagecollection.html#ohRepositoryDeleteObject">ohRepositoryDeleteObject</a> and <a class="el" href="func_garbagecollection.html#ohRepositoryCollectGarbage">ohRepositoryCollectGarbage</a>. </li>
<li>Referencing objects by raw strings circumvents Excel's dependency tracking mechanism. Triggers can be used to force Excel to reestablish dependencies between cells.</li>
</ul>
<h1><a class="anchor" id="ref_references"></a>
References</h1>
<p>Consider the case where cell A1 constructs an object called "my_object" which is used as an input value to a formula in cell A2. A2's dependence on A1 may be established in one of two ways: </p><ul>
<li>The excel cell range A1 may be specified as the value for the given argument of the function in A2 </li>
<li>The literal string "my_object" may be passed as the value to the function in A2</li>
</ul>
<p>The usual approach is to use cell references. This exploits Excel's dependency tree, e.g. Excel ensures that cell A1 is calculated before A2. When raw strings are used, Excel cannot see that cell A2 depends on cell A1. In this trivial example there would be no advantage in using raw strings.</p>
<p>In more sophisticated applications, the use of raw strings may provide additional flexibility, at the cost of some manual overhead on the part of the spreadsheet designer. For example, during initialization a collection of known objects may be instantiated on a workbook which is then closed. For the duration of this Excel session these objects may be referenced by their names, without the need for the referencing workbook to hold a link to the initialization book where the objects were instantiated.</p>
<p>When an object is created with an ID such as "my_object", the addin automatically appends an update counter to the ID and the value returned to the cell appears in the format "my_object#9999". Either form may be used to reference the object.</p>
<h1><a class="anchor" id="ref_permanent"></a>
Permanent Objects</h1>
<p>The last argument of every constructor is a flag called "permanent". This is a flag indicating whether the object is to be permanent or not. It's a boolean but is implemented as datatype <code>any</code> so that it can be omitted (default = false).</p>
<p>Permanent objects are not deleted by functions <a class="el" href="func_garbagecollection.html#ohRepositoryDeleteAllObjects">ohRepositoryDeleteAllObjects</a> / <a class="el" href="func_garbagecollection.html#ohRepositoryCollectGarbage">ohRepositoryCollectGarbage</a>, allowing finer granularity in managing the objects in the repository. For example in the scenario described above where global objects are initialized at startup on a workbook which is then closed, these objects might be declared permanent, so that functions <a class="el" href="func_garbagecollection.html#ohRepositoryDeleteAllObjects">ohRepositoryDeleteAllObjects</a> / <a class="el" href="func_garbagecollection.html#ohRepositoryCollectGarbage">ohRepositoryCollectGarbage</a> delete only objects that the user can see. These two functions accept a parameter called "deletePermanent", which defaults to False. Setting deletePermanent = True overrides the default behavior, deleting all objects including those that were declared permanent.</p>
<h1><a class="anchor" id="ref_triggers"></a>
Triggers</h1>
<p>Referencing objects by raw strings rather than Excel references circumvents Excel's dependency tree. Triggers provide a mechanism for forcing dependencies that Excel would otherwise not know about.</p>
<p>Addin functions may be implemented with a dummy "trigger" parameter which can be used for this purpose. The ObjectHandler function <a class="el" href="func_ohutils.html#ohTrigger">ohTrigger</a> can be supplied as the value to the trigger parameter. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
            </div>
            <div class='clearfix'></div>
<div id="footer">SourceForge logo copyright &#169; Open Source Technology Group<br>reposit logo <a href="http://www.reposit.be">copyright &#169; 2015 reposit Ltd Dublin</a><br>all other content <a href="license.html">copyright &#169; 2004-20015 The QuantLib Group</a></div>
        </div>
        <div class='clearfix'></div>
    </div>
    <div class='clearfix'></div>
</body>
</html>
